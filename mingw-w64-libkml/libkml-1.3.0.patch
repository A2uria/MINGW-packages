diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/configure.ac libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/configure.ac
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/configure.ac	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/configure.ac	2016-03-09 17:36:40.993379100 -0300
***************
*** 10,20 ****
--- 10,29 ----
  AM_INIT_AUTOMAKE(-Wall -Werror subdir-objects)
  m4_ifdef([AM_PROG_AR], [AM_PROG_AR])
  
+ AC_PROG_CC
  AC_PROG_CPP
  AC_PROG_CXX
  AC_PROG_INSTALL
  AC_PROG_LIBTOOL
  
+ ## Toggle build options specific to Windows
+ case "${host}" in
+ 	*-*-mingw*) WIN32="yes" ;;
+ 	*cygwin*) WIN32="yes" ;;
+ 	*) WIN32="no" ;;
+ esac
+ AM_CONDITIONAL([WIN32], test "$WIN32" = "yes")
+ 
  AC_C_CONST
  AC_C_INLINE
  AC_FUNC_MALLOC
***************
*** 34,42 ****
  	;;
  	Darwin)	PLATFORM=darwin
  		SHLIBSUFFIX="dylib"
! 	;;
! 	*) 	PLATFORM=unknown
  		SHLIBSUFFIX="so"
  	;;
  esac
  AC_SUBST(PLATFORM)
--- 43,56 ----
  	;;
  	Darwin)	PLATFORM=darwin
  		SHLIBSUFFIX="dylib"
!     ;;
! 	*) if test "$WIN32" = "yes"; then
!         PLATFORM=win32
! 		SHLIBSUFFIX="dll"
!        else
!         PLATFORM=unknown
  		SHLIBSUFFIX="so"
+        fi
  	;;
  esac
  AC_SUBST(PLATFORM)
***************
*** 173,188 ****
  					[AC_MSG_WARN([could not find Python.h. The Python bindings will not be built.])
  			PYTHON=
  			])
! 			PYTHON_LIBNAME="python"
! 			if test "$PLATFORM" = "linux"; then
! 				PYTHON_LIBNAME="python$PYTHON_VERSION"
! 			fi
  			AC_CHECK_LIB($PYTHON_LIBNAME, Py_Initialize,,
  					[AC_MSG_WARN([could not find the Python library. The Python bindings will not be built.])
  			PYTHON=
  			])
  			LIBS=$saved_LIBS  # don't append -lpython here.
  			CPPFLAGS="$current_CPPFLAGS"
  		fi
  	fi
  fi
--- 187,200 ----
  					[AC_MSG_WARN([could not find Python.h. The Python bindings will not be built.])
  			PYTHON=
  			])
! 			PYTHON_LIBNAME="python$PYTHON_VERSION"
  			AC_CHECK_LIB($PYTHON_LIBNAME, Py_Initialize,,
  					[AC_MSG_WARN([could not find the Python library. The Python bindings will not be built.])
  			PYTHON=
  			])
  			LIBS=$saved_LIBS  # don't append -lpython here.
  			CPPFLAGS="$current_CPPFLAGS"
+             AC_SUBST(PYTHON_VERSION)
  		fi
  	fi
  fi
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/engine/Makefile.am libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/engine/Makefile.am
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/engine/Makefile.am	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/engine/Makefile.am	2016-03-09 18:17:44.425149600 -0300
***************
*** 1,5 ****
! AM_CPPFLAGS = -I$(top_srcdir)/src \
! 	      -I$(top_srcdir)/third_party/boost_1_34_1
  
  if GCC
  AM_CXXFLAGS = -Wall -Werror -pedantic -Wno-long-long -fno-rtti
--- 1,4 ----
! AM_CPPFLAGS = -I$(top_srcdir)/src
  
  if GCC
  AM_CXXFLAGS = -Wall -Werror -pedantic -Wno-long-long -fno-rtti
***************
*** 11,106 ****
  	streamkml
  
  balloonwalker_SOURCES = balloonwalker.cc
! balloonwalker_LDADD = \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  clone_SOURCES = clone.cc
! clone_LDADD = \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  csv2kml_SOURCES = csv2kml.cc
! csv2kml_LDADD = \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  csvinfo_SOURCES = csvinfo.cc
! csvinfo_LDADD = \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  import_SOURCES = import.cc
! import_LDADD = \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  inlinestyles_SOURCES = inlinestyles.cc
! inlinestyles_LDADD = \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  kmlfile_SOURCES = kmlfile.cc
! kmlfile_LDADD = \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  kml2kmz_SOURCES = kml2kmz.cc
! kml2kmz_LDADD = \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  kmzchecklinks_SOURCES = kmzchecklinks.cc
! kmzchecklinks_LDADD = \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  oldschema_SOURCES = oldschema.cc
! oldschema_LDADD = \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  parsebig_SOURCES = parsebig.cc
! parsebig_LDADD = \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  printstyle_SOURCES = printstyle.cc
! printstyle_LDADD = \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  change_SOURCES = change.cc
! change_LDADD = \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  splitstyles_SOURCES = splitstyles.cc
! splitstyles_LDADD = \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  streamkml_SOURCES = streamkml.cc
! streamkml_LDADD = \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
--- 10,55 ----
  	streamkml
  
  balloonwalker_SOURCES = balloonwalker.cc
! balloonwalker_LDADD = $(top_builddir)/src/kml/engine/libkmlengine.la
  
  clone_SOURCES = clone.cc
! clone_LDADD = $(top_builddir)/src/kml/engine/libkmlengine.la
  
  csv2kml_SOURCES = csv2kml.cc
! csv2kml_LDADD = $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  csvinfo_SOURCES = csvinfo.cc
! csvinfo_LDADD = $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  import_SOURCES = import.cc
! import_LDADD = $(top_builddir)/src/kml/engine/libkmlengine.la
  
  inlinestyles_SOURCES = inlinestyles.cc
! inlinestyles_LDADD = $(top_builddir)/src/kml/engine/libkmlengine.la
  
  kmlfile_SOURCES = kmlfile.cc
! kmlfile_LDADD = $(top_builddir)/src/kml/engine/libkmlengine.la
  
  kml2kmz_SOURCES = kml2kmz.cc
! kml2kmz_LDADD = $(top_builddir)/src/kml/engine/libkmlengine.la
  
  kmzchecklinks_SOURCES = kmzchecklinks.cc
! kmzchecklinks_LDADD = $(top_builddir)/src/kml/engine/libkmlengine.la
  
  oldschema_SOURCES = oldschema.cc
! oldschema_LDADD = $(top_builddir)/src/kml/engine/libkmlengine.la
  
  parsebig_SOURCES = parsebig.cc
! parsebig_LDADD = $(top_builddir)/src/kml/engine/libkmlengine.la
  
  printstyle_SOURCES = printstyle.cc
! printstyle_LDADD = $(top_builddir)/src/kml/engine/libkmlengine.la
  
  change_SOURCES = change.cc
! change_LDADD = $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  splitstyles_SOURCES = splitstyles.cc
! splitstyles_LDADD = $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  streamkml_SOURCES = streamkml.cc
! streamkml_LDADD = $(top_builddir)/src/kml/convenience/libkmlconvenience.la
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/gpx/Makefile.am libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/gpx/Makefile.am
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/gpx/Makefile.am	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/gpx/Makefile.am	2016-03-09 18:11:24.569084800 -0300
***************
*** 1,5 ****
! AM_CPPFLAGS = -I$(top_srcdir)/src \
! 	      -I$(top_srcdir)/third_party/boost_1_34_1
  
  if GCC
  AM_CXXFLAGS = -Wall -Werror -pedantic -Wno-long-long -fno-rtti
--- 1,4 ----
! AM_CPPFLAGS = -I$(top_srcdir)/src
  
  if GCC
  AM_CXXFLAGS = -Wall -Werror -pedantic -Wno-long-long -fno-rtti
***************
*** 8,16 ****
  noinst_PROGRAMS = gpxtracktokml
  
  gpxtracktokml_SOURCES = gpxtracktokml.cc
! gpxtracktokml_LDADD = \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
--- 7,11 ----
  noinst_PROGRAMS = gpxtracktokml
  
  gpxtracktokml_SOURCES = gpxtracktokml.cc
! gpxtracktokml_LDADD = $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/gx/Makefile.am libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/gx/Makefile.am
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/gx/Makefile.am	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/gx/Makefile.am	2016-03-09 18:10:54.497081800 -0300
***************
*** 1,5 ****
! AM_CPPFLAGS = -I$(top_srcdir)/src \
! 	      -I$(top_srcdir)/third_party/boost_1_34_1
  
  if GCC
  AM_CXXFLAGS = -Wall -Werror -pedantic -Wno-long-long -fno-rtti
--- 1,4 ----
! AM_CPPFLAGS = -I$(top_srcdir)/src
  
  if GCC
  AM_CXXFLAGS = -Wall -Werror -pedantic -Wno-long-long -fno-rtti
***************
*** 9,24 ****
  	gpxfly featuretour
  
  gpxfly_SOURCES = gpxfly.cc
! gpxfly_LDADD = \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  featuretour_SOURCES = featuretour.cc
! featuretour_LDADD = \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
--- 8,15 ----
  	gpxfly featuretour
  
  gpxfly_SOURCES = gpxfly.cc
! gpxfly_LDADD = $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  featuretour_SOURCES = featuretour.cc
! featuretour_LDADD = $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/hellonet/csvurl2gmap.cc libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/hellonet/csvurl2gmap.cc
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/hellonet/csvurl2gmap.cc	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/hellonet/csvurl2gmap.cc	2016-03-09 17:36:41.024631600 -0300
***************
*** 23,29 ****
  // OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF 
  // ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  
- #include <termios.h>
  #include <time.h>
  #include <iostream>
  #include <string>
--- 23,28 ----
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/hellonet/Makefile.am libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/hellonet/Makefile.am
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/hellonet/Makefile.am	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/hellonet/Makefile.am	2016-03-09 18:15:40.673175400 -0300
***************
*** 1,7 ****
  if HAVE_CURL
! AM_CPPFLAGS = -I$(top_srcdir)/src \
! 	      -I$(top_srcdir)/examples/hellonet \
! 	      -I$(top_srcdir)/third_party/boost_1_34_1
  
  if GCC
  AM_CXXFLAGS = -Wall -Werror -pedantic -Wno-long-long -fno-rtti
--- 1,5 ----
  if HAVE_CURL
! AM_CPPFLAGS = -I$(top_srcdir)/src -I$(top_srcdir)/examples/hellonet
  
  if GCC
  AM_CXXFLAGS = -Wall -Werror -pedantic -Wno-long-long -fno-rtti
***************
*** 18,166 ****
  libcurlfetch_la_LIBADD = -lcurl
  
  csvurl2gmap_SOURCES = csvurl2gmap.cc
! csvurl2gmap_LDADD = \
!         libcurlfetch.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  getgmapkml_SOURCES = getgmapkml.cc
! getgmapkml_LDADD = \
!         libcurlfetch.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  getgsheetcsv_SOURCES = getgsheetcsv.cc
! getgsheetcsv_LDADD = \
!         libcurlfetch.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  getgsheetkml_SOURCES = getgsheetkml.cc
! getgsheetkml_LDADD = \
!         libcurlfetch.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  gsheet2gmap_SOURCES = gsheet2gmap.cc
! gsheet2gmap_LDADD = \
!         libcurlfetch.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  kmlwalk_SOURCES = kmlwalk.cc
! kmlwalk_LDADD = \
!         libcurlfetch.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  kmzfetch_SOURCES = kmzfetch.cc
! kmzfetch_LDADD = \
!         libcurlfetch.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  listfeed_SOURCES = listfeed.cc
! listfeed_LDADD = \
!         libcurlfetch.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  listgdocs_SOURCES = listgdocs.cc
! listgdocs_LDADD = \
!         libcurlfetch.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  listgmaps_SOURCES = listgmaps.cc
! listgmaps_LDADD = \
!         libcurlfetch.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  listgphotos_SOURCES = listgphotos.cc
! listgphotos_LDADD = \
!         libcurlfetch.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  resolvestyle_SOURCES = resolvestyle.cc
! resolvestyle_LDADD = \
!         libcurlfetch.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  searchgmap_SOURCES = searchgmap.cc
! searchgmap_LDADD = \
!         libcurlfetch.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  uploadgmap_SOURCES = uploadgmap.cc
! uploadgmap_LDADD = \
!         libcurlfetch.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  uploadgmapcsv_SOURCES = uploadgmapcsv.cc
! uploadgmapcsv_LDADD = \
!         libcurlfetch.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  uploadgmapkml_SOURCES = uploadgmapkml.cc
! uploadgmapkml_LDADD = \
!         libcurlfetch.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  uploadgsheet_SOURCES = uploadgsheet.cc
! uploadgsheet_LDADD = \
!         libcurlfetch.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  xsdprint_SOURCES = xsdprint.cc
! xsdprint_LDADD = \
!         libcurlfetch.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/xsd/libkmlxsd.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  EXTRA_DIST = README curlfetch.h prompt.h
  endif
--- 16,92 ----
  libcurlfetch_la_LIBADD = -lcurl
  
  csvurl2gmap_SOURCES = csvurl2gmap.cc
! csvurl2gmap_LDADD = libcurlfetch.la \
!         $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  getgmapkml_SOURCES = getgmapkml.cc
! getgmapkml_LDADD = libcurlfetch.la \
!         $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  getgsheetcsv_SOURCES = getgsheetcsv.cc
! getgsheetcsv_LDADD = libcurlfetch.la \
!         $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  getgsheetkml_SOURCES = getgsheetkml.cc
! getgsheetkml_LDADD = libcurlfetch.la \
!         $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  gsheet2gmap_SOURCES = gsheet2gmap.cc
! gsheet2gmap_LDADD = libcurlfetch.la \
!         $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  kmlwalk_SOURCES = kmlwalk.cc
! kmlwalk_LDADD = libcurlfetch.la \
!         $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  kmzfetch_SOURCES = kmzfetch.cc
! kmzfetch_LDADD = libcurlfetch.la \
!         $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  listfeed_SOURCES = listfeed.cc
! listfeed_LDADD = libcurlfetch.la \
!         $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  listgdocs_SOURCES = listgdocs.cc
! listgdocs_LDADD = libcurlfetch.la \
!         $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  listgmaps_SOURCES = listgmaps.cc
! listgmaps_LDADD = libcurlfetch.la \
!         $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  listgphotos_SOURCES = listgphotos.cc
! listgphotos_LDADD = libcurlfetch.la \
!         $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  resolvestyle_SOURCES = resolvestyle.cc
! resolvestyle_LDADD = libcurlfetch.la \
!         $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  searchgmap_SOURCES = searchgmap.cc
! searchgmap_LDADD = libcurlfetch.la \
!         $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  uploadgmap_SOURCES = uploadgmap.cc
! uploadgmap_LDADD = libcurlfetch.la \
!         $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  uploadgmapcsv_SOURCES = uploadgmapcsv.cc
! uploadgmapcsv_LDADD = libcurlfetch.la \
!         $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  uploadgmapkml_SOURCES = uploadgmapkml.cc
! uploadgmapkml_LDADD = libcurlfetch.la \
!         $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  uploadgsheet_SOURCES = uploadgsheet.cc
! uploadgsheet_LDADD = libcurlfetch.la \
!         $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  xsdprint_SOURCES = xsdprint.cc
! xsdprint_LDADD = libcurlfetch.la \
!         $(top_builddir)/src/kml/convenience/libkmlconvenience.la \
!         $(top_builddir)/src/kml/xsd/libkmlxsd.la
  
  EXTRA_DIST = README curlfetch.h prompt.h
  endif
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/hellonet/prompt.h libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/hellonet/prompt.h
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/hellonet/prompt.h	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/hellonet/prompt.h	2016-03-09 17:36:41.024631600 -0300
***************
*** 28,36 ****
  #ifndef EXAMPLES_HELLONET_PROMPT_H__
  #define EXAMPLES_HELLONET_PROMPT_H__
  
- #include <termios.h>
  #include <iostream>
  #include <string>
  
  // This class provides some static methods useful for prompting on a terminal.
  class Prompt {
--- 28,36 ----
  #ifndef EXAMPLES_HELLONET_PROMPT_H__
  #define EXAMPLES_HELLONET_PROMPT_H__
  
  #include <iostream>
  #include <string>
+ #include "setstdinecho.h"
  
  // This class provides some static methods useful for prompting on a terminal.
  class Prompt {
***************
*** 39,56 ****
      std::cin.get();
      std::cout << prompt;
      std::cout << std::flush;
-     // Get the current state of the input terminal.
-     struct termios t;
-     tcgetattr(0, &t);
      // Flip off the ECHO bit.
!     t.c_lflag &= ~ECHO;
!     tcsetattr(0, TCSANOW, &t);
      // User can now type password safely.
      std::string input;
      std::getline(std::cin, input);
      // Flip ECHO back on.
!     t.c_lflag |= ECHO;
!     tcsetattr(0, TCSANOW, &t);
      std::cout << std::endl;
      return input;
    }
--- 39,51 ----
      std::cin.get();
      std::cout << prompt;
      std::cout << std::flush;
      // Flip off the ECHO bit.
!     SetStdinEcho(false);
      // User can now type password safely.
      std::string input;
      std::getline(std::cin, input);
      // Flip ECHO back on.
!     SetStdinEcho(true);
      std::cout << std::endl;
      return input;
    }
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/hellonet/uploadgmap.cc libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/hellonet/uploadgmap.cc
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/hellonet/uploadgmap.cc	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/hellonet/uploadgmap.cc	2016-03-09 17:36:41.040258400 -0300
***************
*** 27,33 ****
  // Maps Data API.  The URI of feed to the new map is printed on output.
  // The created map has only the Placemarks from the original file.
  
- #include <termios.h>
  #include <iostream>
  #include <string>
  #include "boost/scoped_ptr.hpp"
--- 27,32 ----
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/hellonet/uploadgmapkml.cc libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/hellonet/uploadgmapkml.cc
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/hellonet/uploadgmapkml.cc	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/hellonet/uploadgmapkml.cc	2016-03-09 17:36:41.040258400 -0300
***************
*** 23,29 ****
  // OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF 
  // ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  
- #include <termios.h>
  #include <iostream>
  #include <string>
  #include "boost/scoped_ptr.hpp"
--- 23,28 ----
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/hellonet/uploadgsheet.cc libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/hellonet/uploadgsheet.cc
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/hellonet/uploadgsheet.cc	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/hellonet/uploadgsheet.cc	2016-03-09 17:36:41.040258400 -0300
***************
*** 23,29 ****
  // OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF 
  // ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  
- #include <termios.h>
  #include <iostream>
  #include <string>
  #include "boost/scoped_ptr.hpp"
--- 23,28 ----
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/helloworld/Makefile.am libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/helloworld/Makefile.am
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/helloworld/Makefile.am	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/helloworld/Makefile.am	2016-03-09 18:10:10.757675600 -0300
***************
*** 1,6 ****
! AM_CPPFLAGS = -I$(top_srcdir)/src \
! 	      -I$(top_srcdir)/examples/helloworld \
! 	      -I$(top_srcdir)/third_party/boost_1_34_1
  
  
  if GCC
--- 1,4 ----
! AM_CPPFLAGS = -I$(top_srcdir)/src -I$(top_srcdir)/examples/helloworld
  
  
  if GCC
***************
*** 10,16 ****
  noinst_LTLIBRARIES = libhelloutil.la
  
  libhelloutil_la_SOURCES = print.cc
! libhelloutil_la_LIBADD = $(top_builddir)/third_party/libminizip.la
  
  noinst_PROGRAMS = countkml createkml checklinks circlegen helloattrs helloenum \
                    hellofeatures hellofolder hellogeometry hellohref hellokmz \
--- 8,14 ----
  noinst_LTLIBRARIES = libhelloutil.la
  
  libhelloutil_la_SOURCES = print.cc
! libhelloutil_la_LIBADD = $(top_builddir)/third_party/libminizipext.la
  
  noinst_PROGRAMS = countkml createkml checklinks circlegen helloattrs helloenum \
                    hellofeatures hellofolder hellogeometry hellohref hellokmz \
***************
*** 18,136 ****
                    printgeometry sharedstyles simplifylines sortplacemarks
  
  createkml_SOURCES = createkml.cc
! createkml_LDADD = \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  circlegen_SOURCES = circlegen.cc
! circlegen_LDADD = \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la
  
  checklinks_SOURCES = checklinks.cc
! checklinks_LDADD = \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  countkml_SOURCES = countkml.cc
! countkml_LDADD = \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  helloattrs_SOURCES = helloattrs.cc
! helloattrs_LDADD = \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  helloenum_SOURCES = helloenum.cc
! helloenum_LDADD = \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  hellofeatures_SOURCES = hellofeatures.cc
! hellofeatures_LDADD = \
! 	libhelloutil.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  hellofolder_SOURCES = hellofolder.cc
! hellofolder_LDADD = \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  hellogeometry_SOURCES = hellogeometry.cc
! hellogeometry_LDADD = \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  hellohref_SOURCES = hellohref.cc
! hellohref_LDADD = \
! 	libhelloutil.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  hellokmz_SOURCES = hellokmz.cc
! hellokmz_LDADD = \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  helloregion_SOURCES = helloregion.cc
! helloregion_LDADD = \
! 	libhelloutil.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  helloworld_SOURCES = helloworld.cc
! helloworld_LDADD = \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  parsekml_SOURCES = parsekml.cc
! parsekml_LDADD = \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  parsens_SOURCES = parsens.cc
! parsens_LDADD = \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  prettykml_SOURCES = prettykml.cc
! prettykml_LDADD = \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  printgeometry_SOURCES = printgeometry.cc
! printgeometry_LDADD = \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  sharedstyles_SOURCES = sharedstyles.cc
! sharedstyles_LDADD = \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  simplifylines_SOURCES = simplifylines.cc
! simplifylines_LDADD = \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  sortplacemarks_SOURCES = sortplacemarks.cc
! sortplacemarks_LDADD = \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  EXTRA_DIST = \
  	print.h
--- 16,79 ----
                    printgeometry sharedstyles simplifylines sortplacemarks
  
  createkml_SOURCES = createkml.cc
! createkml_LDADD = $(top_builddir)/src/kml/dom/libkmldom.la
  
  circlegen_SOURCES = circlegen.cc
! circlegen_LDADD = $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  checklinks_SOURCES = checklinks.cc
! checklinks_LDADD = $(top_builddir)/src/kml/engine/libkmlengine.la
  
  countkml_SOURCES = countkml.cc
! countkml_LDADD = $(top_builddir)/src/kml/engine/libkmlengine.la
  
  helloattrs_SOURCES = helloattrs.cc
! helloattrs_LDADD = $(top_builddir)/src/kml/dom/libkmldom.la
  
  helloenum_SOURCES = helloenum.cc
! helloenum_LDADD = $(top_builddir)/src/kml/dom/libkmldom.la
  
  hellofeatures_SOURCES = hellofeatures.cc
! hellofeatures_LDADD = libhelloutil.la $(top_builddir)/src/kml/dom/libkmldom.la
  
  hellofolder_SOURCES = hellofolder.cc
! hellofolder_LDADD = $(top_builddir)/src/kml/dom/libkmldom.la
  
  hellogeometry_SOURCES = hellogeometry.cc
! hellogeometry_LDADD = $(top_builddir)/src/kml/dom/libkmldom.la
  
  hellohref_SOURCES = hellohref.cc
! hellohref_LDADD = libhelloutil.la $(top_builddir)/src/kml/dom/libkmldom.la
  
  hellokmz_SOURCES = hellokmz.cc
! hellokmz_LDADD = $(top_builddir)/src/kml/engine/libkmlengine.la
  
  helloregion_SOURCES = helloregion.cc
! helloregion_LDADD = libhelloutil.la $(top_builddir)/src/kml/dom/libkmldom.la
  
  helloworld_SOURCES = helloworld.cc
! helloworld_LDADD = $(top_builddir)/src/kml/dom/libkmldom.la
  
  parsekml_SOURCES = parsekml.cc
! parsekml_LDADD = $(top_builddir)/src/kml/dom/libkmldom.la
  
  parsens_SOURCES = parsens.cc
! parsens_LDADD = $(top_builddir)/src/kml/dom/libkmldom.la
  
  prettykml_SOURCES = prettykml.cc
! prettykml_LDADD = $(top_builddir)/src/kml/engine/libkmlengine.la
  
  printgeometry_SOURCES = printgeometry.cc
! printgeometry_LDADD = $(top_builddir)/src/kml/engine/libkmlengine.la
  
  sharedstyles_SOURCES = sharedstyles.cc
! sharedstyles_LDADD = $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  simplifylines_SOURCES = simplifylines.cc
! simplifylines_LDADD = $(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  sortplacemarks_SOURCES = sortplacemarks.cc
! sortplacemarks_LDADD = $(top_builddir)/src/kml/engine/libkmlengine.la
  
  EXTRA_DIST = \
  	print.h
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/regionator/Makefile.am libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/regionator/Makefile.am
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/regionator/Makefile.am	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/regionator/Makefile.am	2016-03-09 18:07:32.009646500 -0300
***************
*** 1,6 ****
! AM_CPPFLAGS = -I$(top_srcdir)/src \
!               -I$(top_srcdir)/third_party/boost_1_34_1 \
!               -I$(top_srcdir)/third_party/zlib-1.2.3/contrib
  
  if GCC
  AM_CXXFLAGS = -Wall -Werror -pedantic -Wno-long-long -fno-rtti
--- 1,4 ----
! AM_CPPFLAGS = -I$(top_srcdir)/src
  
  if GCC
  AM_CXXFLAGS = -Wall -Werror -pedantic -Wno-long-long -fno-rtti
***************
*** 9,26 ****
  noinst_PROGRAMS = csvregionator kmlregionator
  
  csvregionator_SOURCES = csvregionator.cc
! csvregionator_LDADD = \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/regionator/libkmlregionator.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la
  
  kmlregionator_SOURCES = kmlregionator.cc
! kmlregionator_LDADD = \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/regionator/libkmlregionator.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la
  
--- 7,14 ----
  noinst_PROGRAMS = csvregionator kmlregionator
  
  csvregionator_SOURCES = csvregionator.cc
! csvregionator_LDADD = $(top_builddir)/src/kml/regionator/libkmlregionator.la
  
  kmlregionator_SOURCES = kmlregionator.cc
! kmlregionator_LDADD = $(top_builddir)/src/kml/regionator/libkmlregionator.la
  
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/xsd/Makefile.am libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/xsd/Makefile.am
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/examples/xsd/Makefile.am	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/examples/xsd/Makefile.am	2016-03-09 18:17:02.073745500 -0300
***************
*** 1,6 ****
! AM_CPPFLAGS = -I$(top_srcdir)/src \
! 	      -I$(top_srcdir)/examples/xsd \
! 	      -I$(top_srcdir)/third_party/boost_1_34_1
  
  if GCC
  AM_CXXFLAGS = -Wall -Werror -pedantic -Wno-long-long -fno-rtti
--- 1,4 ----
! AM_CPPFLAGS = -I$(top_srcdir)/src -I$(top_srcdir)/examples/xsd
  
  if GCC
  AM_CXXFLAGS = -Wall -Werror -pedantic -Wno-long-long -fno-rtti
***************
*** 11,50 ****
  xsdchildren_SOURCES = xsdchildren.cc
  xsdchildren_LDADD = \
  	$(top_builddir)/src/kml/xsd/libkmlxsd.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  xsdcoverage_SOURCES = xsdcoverage.cc
  xsdcoverage_LDADD = \
  	$(top_builddir)/src/kml/xsd/libkmlxsd.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  xsdelements_SOURCES = xsdelements.cc
  xsdelements_LDADD = \
  	$(top_builddir)/src/kml/xsd/libkmlxsd.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  xsdenums_SOURCES = xsdenums.cc
  xsdenums_LDADD = \
  	$(top_builddir)/src/kml/xsd/libkmlxsd.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  xsdfind_SOURCES = xsdfind.cc
  xsdfind_LDADD = \
  	$(top_builddir)/src/kml/xsd/libkmlxsd.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  xsdtypes_SOURCES = xsdtypes.cc
  xsdtypes_LDADD = \
  	$(top_builddir)/src/kml/xsd/libkmlxsd.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  EXTRA_DIST = \
  	kml-aliases.txt
--- 9,40 ----
  xsdchildren_SOURCES = xsdchildren.cc
  xsdchildren_LDADD = \
  	$(top_builddir)/src/kml/xsd/libkmlxsd.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la
  
  xsdcoverage_SOURCES = xsdcoverage.cc
  xsdcoverage_LDADD = \
  	$(top_builddir)/src/kml/xsd/libkmlxsd.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la
  
  xsdelements_SOURCES = xsdelements.cc
  xsdelements_LDADD = \
  	$(top_builddir)/src/kml/xsd/libkmlxsd.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la
  
  xsdenums_SOURCES = xsdenums.cc
  xsdenums_LDADD = \
  	$(top_builddir)/src/kml/xsd/libkmlxsd.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la 
  
  xsdfind_SOURCES = xsdfind.cc
  xsdfind_LDADD = \
  	$(top_builddir)/src/kml/xsd/libkmlxsd.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la 
  
  xsdtypes_SOURCES = xsdtypes.cc
  xsdtypes_LDADD = \
  	$(top_builddir)/src/kml/xsd/libkmlxsd.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la
  
  EXTRA_DIST = \
  	kml-aliases.txt
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/date_time.cc libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/date_time.cc
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/date_time.cc	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/date_time.cc	2016-03-09 17:36:41.055883200 -0300
***************
*** 29,40 ****
  #include "boost/scoped_ptr.hpp"
  #include <stdlib.h>
  
- // TODO: fix this for real.
  #ifdef _WIN32
! char* strptime(const char* buf, const char* format, struct tm* tm) {
!   // Not yet implemented on this platform.
!   return NULL;
! }
  #endif
  
  namespace kmlbase {
--- 29,39 ----
  #include "boost/scoped_ptr.hpp"
  #include <stdlib.h>
  
  #ifdef _WIN32
! #   include "strptime.h"
! #   include "timegm.h"
! #else
! #   include <time.h>
  #endif
  
  namespace kmlbase {
***************
*** 55,91 ****
    return date_time.get() ? date_time->GetTimeT() : 0;
  }
  
- // Overkill since all time_t's on a 32-bit that are divisible by four are
- // leap years, but this should handle the 2100 case (not a LY) on 64-bit
- // systems.
- static bool is_leap(int year) {
-   year += 1900;
-   return (year % 4) == 0 && ((year % 100) != 0 || (year % 400) == 0);
- }
- 
  time_t DateTime::GetTimeT() const {
!   // Always return time as GMT; disregard local time, unlike  mktime(3).
!   // Faster (and less "obviously correct") implementations are possible.
!   static const unsigned ndays[2][12] ={
!     {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31},
!     {31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31}};
!   time_t res = 0;
! 
!   // This and is_leap() base from 1970, the epoch of a time_t.
!   for (int year = 70; year < tm_.tm_year; ++year)
!     res += is_leap(year) ? 366 : 365;
! 
!   for (int month = 0; month < tm_.tm_mon; ++month)
!     res += ndays[is_leap(tm_.tm_year)][month];
! 
!   res += tm_.tm_mday - 1;
!   res *= 24;
!   res += tm_.tm_hour;
!   res *= 60;
!   res += tm_.tm_min;
!   res *= 60;
!   res += tm_.tm_sec;
!   return res;
  }
  
  template<int N>
--- 54,61 ----
    return date_time.get() ? date_time->GetTimeT() : 0;
  }
  
  time_t DateTime::GetTimeT() const {
!   return timegm(&tm_);
  }
  
  template<int N>
***************
*** 113,119 ****
  
  // private
  bool DateTime::ParseXsdDateTime(const string& xsd_date_time) {
-   // TODO: strptime on win32?
    return strptime(xsd_date_time.c_str(), "%Y-%m-%dT%H:%M:%SZ", &tm_) != NULL;
  }
  
--- 83,88 ----
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/date_time.h libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/date_time.h
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/date_time.h	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/date_time.h	2016-03-09 17:36:41.071508800 -0300
***************
*** 31,42 ****
  #include <time.h>
  #include "kml/base/util.h"
  
- // TODO: fix this for real.
- #ifdef _WIN32
- time_t timegm(struct tm* tm);
- char* strptime(const char* buf, const char* format, struct tm* tm);
- #endif
- 
  namespace kmlbase {
  
  class DateTime {
--- 31,36 ----
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/file.cc libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/file.cc
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/file.cc	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/file.cc	2016-03-09 17:36:41.071508800 -0300
***************
*** 31,37 ****
  
  namespace kmlbase {
  
! #ifdef WIN32
    const char kSeparator = '\\';
  #else
    const char kSeparator = '/';
--- 31,37 ----
  
  namespace kmlbase {
  
! #ifdef _WIN32
    const char kSeparator = '\\';
  #else
    const char kSeparator = '/';
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/file_test.cc libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/file_test.cc
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/file_test.cc	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/file_test.cc	2016-03-09 17:36:41.071508800 -0300
***************
*** 104,110 ****
    const string kExpected_win32_nosep("/tom/dick\\harry");
    const string kExpected_win32_sep("/tom/dick/\\harry");
    // Passing cases.
! #ifdef WIN32
    ASSERT_EQ(kExpected_win32_nosep, File::JoinPaths(kPath1NoSep, kPath2));
    ASSERT_EQ(kExpected_win32_sep, File::JoinPaths(kPath1Sep, kPath2));
  #else
--- 104,110 ----
    const string kExpected_win32_nosep("/tom/dick\\harry");
    const string kExpected_win32_sep("/tom/dick/\\harry");
    // Passing cases.
! #ifdef _WIN32
    ASSERT_EQ(kExpected_win32_nosep, File::JoinPaths(kPath1NoSep, kPath2));
    ASSERT_EQ(kExpected_win32_sep, File::JoinPaths(kPath1Sep, kPath2));
  #else
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/file_win32.cc libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/file_win32.cc
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/file_win32.cc	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/file_win32.cc	2016-03-09 17:36:41.087134700 -0300
***************
*** 32,66 ****
  #include "kml/base/file.h"
  #include <windows.h>
  #include <tchar.h>
- #include <xstring>
  #include <algorithm>
  
  namespace kmlbase {
  
- // Internal to the win32 file class. We need a conversion from string to
- // LPCWSTR.
- static std::wstring Str2Wstr(const string& str) {
-   std::wstring wstr(str.length(), L'');
-   std::copy(str.begin(), str.end(), wstr.begin());
-   return wstr;
- }
- 
- // Internal to the win32 file class. We need a conversion from std::wstring to
- // string.
- string Wstr2Str(const std::wstring& wstr) {
-   size_t s = wstr.size();
-   string str(static_cast<int>(s+1), 0);
-   WideCharToMultiByte(CP_ACP, 0, wstr.c_str(), static_cast<int>(s), &str[0],
-                       static_cast<int>(s), NULL, NULL);
-   return str;
- }
- 
  bool File::Exists(const string& full_path) {
    if (full_path.empty()) {
      return false;
    }
!   std::wstring wstr = Str2Wstr(full_path);
!   DWORD attrs = ::GetFileAttributes(wstr.c_str());
    return (attrs != INVALID_FILE_ATTRIBUTES) &&
      ((attrs & FILE_ATTRIBUTE_DIRECTORY) == 0);
  }
--- 32,46 ----
  #include "kml/base/file.h"
  #include <windows.h>
  #include <tchar.h>
  #include <algorithm>
  
  namespace kmlbase {
  
  bool File::Exists(const string& full_path) {
    if (full_path.empty()) {
      return false;
    }
!   DWORD attrs = ::GetFileAttributes(full_path.c_str());
    return (attrs != INVALID_FILE_ATTRIBUTES) &&
      ((attrs & FILE_ATTRIBUTE_DIRECTORY) == 0);
  }
***************
*** 69,76 ****
    if (filepath.empty()) {
      return false;
    }
!   std::wstring wstr = Str2Wstr(filepath);
!   return ::DeleteFile(wstr.c_str()) ? true : false;
  }
  
  static const unsigned int BUFSIZE = 1024;
--- 49,55 ----
    if (filepath.empty()) {
      return false;
    }
!   return ::DeleteFile(filepath.c_str()) ? true : false;
  }
  
  static const unsigned int BUFSIZE = 1024;
***************
*** 95,102 ****
    if (uRetVal == 0) {
      return false;
    }
!   string str = Wstr2Str(szTempName);
!   path->assign(str.c_str(), strlen(str.c_str()));
    return true;
  }
  
--- 74,80 ----
    if (uRetVal == 0) {
      return false;
    }
!   path->assign(szTempName, strlen(szTempName));
    return true;
  }
  
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/Makefile.am libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/Makefile.am
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/Makefile.am	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/Makefile.am	2016-03-09 17:36:41.087134700 -0300
***************
*** 1,17 ****
! AM_CPPFLAGS = -I$(top_srcdir)/src \
!               -I$(top_srcdir)/third_party/boost_1_34_1 \
!               -I$(top_srcdir)/third_party/gtest-1.7.0/include \
!               -I$(top_srcdir)/third_party/uriparser-0.7.5/include \
!               -I$(top_srcdir)/third_party/zlib-1.2.3/contrib
  
  if GCC
! AM_CXXFLAGS = -Wall -Wextra -Wno-unused-parameter -Werror -pedantic -fno-rtti
  AM_TEST_CXXFLAGS = -Wall -Wextra -Wno-unused-parameter -Werror -fno-rtti -DGTEST_HAS_RTTI=0
  endif
  
- libkmlbase_la_LDFLAGS = -lexpat
- 
  lib_LTLIBRARIES = libkmlbase.la
  libkmlbase_la_SOURCES = \
  	attributes.cc \
  	csv_splitter.cc \
--- 1,20 ----
! AM_CPPFLAGS = -I$(top_srcdir)/src -I$(top_srcdir)/third_party/minizipext-1.0
  
  if GCC
! AM_CXXFLAGS = -Wall -Wextra -Wno-unused-parameter -Werror -pedantic -fno-rtti -std=c++11
  AM_TEST_CXXFLAGS = -Wall -Wextra -Wno-unused-parameter -Werror -fno-rtti -DGTEST_HAS_RTTI=0
  endif
  
  lib_LTLIBRARIES = libkmlbase.la
+ 
+ if WIN32
+     file_src = file_win32.cc
+     file_ext = file_posix.cc
+ else
+     file_src = file_posix.cc
+     file_ext = file_win32.cc
+ endif
+ 
  libkmlbase_la_SOURCES = \
  	attributes.cc \
  	csv_splitter.cc \
***************
*** 19,25 ****
  	expat_handler_ns.cc \
  	expat_parser.cc \
  	file.cc \
! 	file_posix.cc \
  	math_util.cc \
  	mimetypes.cc \
  	referent.cc \
--- 22,28 ----
  	expat_handler_ns.cc \
  	expat_parser.cc \
  	file.cc \
!     ${file_src} \
  	math_util.cc \
  	mimetypes.cc \
  	referent.cc \
***************
*** 30,38 ****
  	xml_namespaces.cc \
  	zip_file.cc
  
! libkmlbase_la_LIBADD = \
! 	$(top_builddir)/third_party/libminizip.la \
! 	$(top_builddir)/third_party/liburiparser.la
  
  # These header files will be installed in $(includedir)/kml/base
  libkmlbaseincludedir = $(includedir)/kml/base
--- 33,42 ----
  	xml_namespaces.cc \
  	zip_file.cc
  
! if WIN32
!     libkmlbase_la_LDFLAGS = -no-undefined
! endif
! libkmlbase_la_LIBADD = $(top_builddir)/third_party/libminizipext.la -luriparser
  
  # These header files will be installed in $(includedir)/kml/base
  libkmlbaseincludedir = $(includedir)/kml/base
***************
*** 63,69 ****
  	zip_file.h
  
  EXTRA_DIST = \
! 	file_win32.cc \
  	net_cache_test_util.h \
  	unit_test.h \
  	uri_parser.h
--- 67,73 ----
  	zip_file.h
  
  EXTRA_DIST = \
! 	${file_ext} \
  	net_cache_test_util.h \
  	unit_test.h \
  	uri_parser.h
***************
*** 97,212 ****
  
  attributes_test_SOURCES = attributes_test.cc
  attributes_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! attributes_test_LDADD = libkmlbase.la \
! 			$(top_builddir)/third_party/libgtest_main.la
  
  color32_test_SOURCES = color32_test.cc
  color32_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! color32_test_LDADD = libkmlbase.la \
! 		     $(top_builddir)/third_party/libgtest_main.la
  
  csv_splitter_test_SOURCES = csv_splitter_test.cc
  csv_splitter_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! csv_splitter_test_LDADD = libkmlbase.la \
! 			$(top_builddir)/third_party/libgtest_main.la
  
  date_time_test_SOURCES = date_time_test.cc
  date_time_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! date_time_test_LDADD = libkmlbase.la \
! 		       $(top_builddir)/third_party/libgtest_main.la
  
  expat_handler_ns_test_SOURCES = expat_handler_ns_test.cc
  expat_handler_ns_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! expat_handler_ns_test_LDADD = libkmlbase.la \
! 			      $(top_builddir)/third_party/libgtest_main.la
  
  expat_parser_test_SOURCES = expat_parser_test.cc
  expat_parser_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! expat_parser_test_LDADD = libkmlbase.la \
! 			      $(top_builddir)/third_party/libgtest_main.la
  
  file_test_SOURCES = file_test.cc
  file_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! file_test_LDADD = libkmlbase.la \
! 		  $(top_builddir)/third_party/libgtest_main.la
  
  math_util_test_SOURCES = math_util_test.cc
  math_util_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! math_util_test_LDADD = libkmlbase.la \
! 		  $(top_builddir)/third_party/libgtest_main.la
  
  net_cache_test_SOURCES = net_cache_test.cc
  net_cache_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! net_cache_test_LDADD = libkmlbase.la \
!         $(top_builddir)/third_party/liburiparser.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  referent_test_SOURCES = referent_test.cc
  referent_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! referent_test_LDADD= libkmlbase.la \
! 		     $(top_builddir)/third_party/libgtest_main.la
  
  string_util_test_SOURCES = string_util_test.cc
  string_util_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! string_util_test_LDADD= libkmlbase.la \
! 			$(top_builddir)/third_party/libgtest_main.la
  
  tempfile_test_SOURCES = tempfile_test.cc
  tempfile_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! tempfile_test_LDADD = libkmlbase.la \
! 		      $(top_builddir)/third_party/libgtest_main.la
  
  time_util_test_SOURCES = time_util_test.cc
  time_util_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! time_util_test_LDADD= libkmlbase.la \
! 		      $(top_builddir)/third_party/libgtest_main.la
  
  uri_parser_test_SOURCES = uri_parser_test.cc
  uri_parser_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! uri_parser_test_LDADD= libkmlbase.la \
!         $(top_builddir)/third_party/liburiparser.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  util_test_SOURCES = util_test.cc
  util_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! util_test_LDADD= libkmlbase.la \
! 		 $(top_builddir)/third_party/libgtest_main.la
  
  vec3_test_SOURCES = vec3_test.cc
  vec3_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! vec3_test_LDADD= libkmlbase.la \
! 		 $(top_builddir)/third_party/libgtest_main.la
  
  version_test_SOURCES = version_test.cc
  version_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! version_test_LDADD= libkmlbase.la \
! 		 $(top_builddir)/third_party/libgtest_main.la
  
  xml_element_test_SOURCES = xml_element_test.cc
  xml_element_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xml_element_test_LDADD= libkmlbase.la \
! 		 $(top_builddir)/third_party/libgtest_main.la
  
  xml_file_test_SOURCES = xml_file_test.cc
  xml_file_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xml_file_test_LDADD= libkmlbase.la \
! 		 $(top_builddir)/third_party/libgtest_main.la
  
  xml_namespaces_test_SOURCES = xml_namespaces_test.cc
  xml_namespaces_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xml_namespaces_test_LDADD= libkmlbase.la \
! 		 $(top_builddir)/third_party/libgtest_main.la
  
  xmlns_test_SOURCES = xmlns_test.cc
  xmlns_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xmlns_test_LDADD= libkmlbase.la \
! 		  $(top_builddir)/third_party/libgtest_main.la
  
  zip_file_test_SOURCES = zip_file_test.cc
  zip_file_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! zip_file_test_LDADD= libkmlbase.la \
! 		 $(top_builddir)/third_party/libminizip.la \
! 		 $(top_builddir)/third_party/libgtest_main.la
  
  CLEANFILES = check_PROGRAMS
  
--- 101,191 ----
  
  attributes_test_SOURCES = attributes_test.cc
  attributes_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! attributes_test_LDADD = libkmlbase.la -lgtest -lgtest_main
  
  color32_test_SOURCES = color32_test.cc
  color32_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! color32_test_LDADD = libkmlbase.la -lgtest -lgtest_main
  
  csv_splitter_test_SOURCES = csv_splitter_test.cc
  csv_splitter_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! csv_splitter_test_LDADD = libkmlbase.la -lgtest -lgtest_main
  
  date_time_test_SOURCES = date_time_test.cc
  date_time_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! date_time_test_LDADD = libkmlbase.la -lgtest -lgtest_main
  
  expat_handler_ns_test_SOURCES = expat_handler_ns_test.cc
  expat_handler_ns_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! expat_handler_ns_test_LDADD = libkmlbase.la -lgtest -lgtest_main
  
  expat_parser_test_SOURCES = expat_parser_test.cc
  expat_parser_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! expat_parser_test_LDADD = libkmlbase.la -lgtest -lgtest_main
  
  file_test_SOURCES = file_test.cc
  file_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! file_test_LDADD = libkmlbase.la -lgtest -lgtest_main
  
  math_util_test_SOURCES = math_util_test.cc
  math_util_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! math_util_test_LDADD = libkmlbase.la -lgtest -lgtest_main
  
  net_cache_test_SOURCES = net_cache_test.cc
  net_cache_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! net_cache_test_LDADD = libkmlbase.la -luriparser -lgtest -lgtest_main
  
  referent_test_SOURCES = referent_test.cc
  referent_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! referent_test_LDADD= libkmlbase.la -lgtest -lgtest_main
  
  string_util_test_SOURCES = string_util_test.cc
  string_util_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! string_util_test_LDADD= libkmlbase.la -lgtest -lgtest_main
  
  tempfile_test_SOURCES = tempfile_test.cc
  tempfile_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! tempfile_test_LDADD = libkmlbase.la -lgtest -lgtest_main
  
  time_util_test_SOURCES = time_util_test.cc
  time_util_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! time_util_test_LDADD= libkmlbase.la -lgtest -lgtest_main
  
  uri_parser_test_SOURCES = uri_parser_test.cc
  uri_parser_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! uri_parser_test_LDADD= libkmlbase.la -luriparser -lgtest -lgtest_main
  
  util_test_SOURCES = util_test.cc
  util_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! util_test_LDADD= libkmlbase.la -lgtest -lgtest_main
  
  vec3_test_SOURCES = vec3_test.cc
  vec3_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! vec3_test_LDADD= libkmlbase.la -lgtest -lgtest_main
  
  version_test_SOURCES = version_test.cc
  version_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! version_test_LDADD= libkmlbase.la -lgtest -lgtest_main
  
  xml_element_test_SOURCES = xml_element_test.cc
  xml_element_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xml_element_test_LDADD= libkmlbase.la -lgtest -lgtest_main
  
  xml_file_test_SOURCES = xml_file_test.cc
  xml_file_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xml_file_test_LDADD= libkmlbase.la -lgtest -lgtest_main
  
  xml_namespaces_test_SOURCES = xml_namespaces_test.cc
  xml_namespaces_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xml_namespaces_test_LDADD= libkmlbase.la -lgtest -lgtest_main
  
  xmlns_test_SOURCES = xmlns_test.cc
  xmlns_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xmlns_test_LDADD= libkmlbase.la -lgtest -lgtest_main
  
  zip_file_test_SOURCES = zip_file_test.cc
  zip_file_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! zip_file_test_LDADD= libkmlbase.la -lgtest -lgtest_main
  
  CLEANFILES = check_PROGRAMS
  
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/string_util.cc libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/string_util.cc
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/string_util.cc	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/string_util.cc	2016-03-09 17:36:41.087134700 -0300
***************
*** 113,119 ****
  }
  
  bool StringCaseEqual(const string& a, const string& b) {
! #ifdef WIN32
  # define strncasecmp(s1, s2, n) _strnicmp (s1, s2, n)
  #endif
    return a.size() == b.size() && strncasecmp(a.data(), b.data(), a.size()) == 0;
--- 113,119 ----
  }
  
  bool StringCaseEqual(const string& a, const string& b) {
! #if defined(_WIN32) && !defined(strncasecmp)
  # define strncasecmp(s1, s2, n) _strnicmp (s1, s2, n)
  #endif
    return a.size() == b.size() && strncasecmp(a.data(), b.data(), a.size()) == 0;
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/time_util.cc libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/time_util.cc
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/time_util.cc	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/time_util.cc	2016-03-09 17:36:41.087134700 -0300
***************
*** 25,31 ****
  
  #include "kml/base/time_util.h"
  #include <cstddef>  // NULL
! #ifdef WIN32
  #include <winsock2.h>  // This header MUST come before windows.h. See
  #include <windows.h>   // http://code.google.com/p/libkml/issues/detail?id=31
  #include <time.h>
--- 25,31 ----
  
  #include "kml/base/time_util.h"
  #include <cstddef>  // NULL
! #ifdef _WIN32
  #include <winsock2.h>  // This header MUST come before windows.h. See
  #include <windows.h>   // http://code.google.com/p/libkml/issues/detail?id=31
  #include <time.h>
***************
*** 35,41 ****
  
  namespace kmlbase {
  
! #ifdef WIN32
  // http://forums.msdn.microsoft.com/en/vcgeneral/thread/430449b3-f6dd-4e18-84de-eebd26a8d668/
  #if defined(_MSC_VER) || defined(_MSC_EXTENSIONS)
  #define DELTA_EPOCH_IN_MICROSECS  11644473600000000Ui64
--- 35,41 ----
  
  namespace kmlbase {
  
! #ifdef _WIN32
  // http://forums.msdn.microsoft.com/en/vcgeneral/thread/430449b3-f6dd-4e18-84de-eebd26a8d668/
  #if defined(_MSC_VER) || defined(_MSC_EXTENSIONS)
  #define DELTA_EPOCH_IN_MICROSECS  11644473600000000Ui64
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/uri_parser.cc libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/uri_parser.cc
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/uri_parser.cc	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/uri_parser.cc	2016-03-09 17:36:41.102760700 -0300
***************
*** 146,152 ****
  
  bool UriParser::UriToFilename(const string& uri,
                                string* output) {
! #ifdef WIN32
    return UriToWindowsFilename(uri, output);
  #else
    return UriToUnixFilename(uri, output);
--- 146,152 ----
  
  bool UriParser::UriToFilename(const string& uri,
                                string* output) {
! #ifdef _WIN32
    return UriToWindowsFilename(uri, output);
  #else
    return UriToUnixFilename(uri, output);
***************
*** 187,197 ****
  
  bool UriParser::FilenameToUri(const string& filename,
                                string* output) {
! #ifdef WIN32
!   return WindowsFilenameToUri(filename, output);
! #else
!   return UnixFilenameToUri(filename, output);
! #endif
  }
  
  bool UriParser::UnixFilenameToUri(const string& filename,
--- 187,196 ----
  
  bool UriParser::FilenameToUri(const string& filename,
                                string* output) {
!   if (filename.find('\\') != string::npos)
!     return WindowsFilenameToUri(filename, output);
!   else
!     return UnixFilenameToUri(filename, output);
  }
  
  bool UriParser::UnixFilenameToUri(const string& filename,
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/uri_parser_test.cc libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/uri_parser_test.cc
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/uri_parser_test.cc	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/uri_parser_test.cc	2016-03-09 17:36:41.102760700 -0300
***************
*** 412,418 ****
    // This simply tests that the ifdef works as expected.
    string uri;
    string expected_filename;
! #ifdef WIN32
    uri = "file:///C:/home/libkml/foo.bar";
    expected_filename = "C:\\home\\libkml\\foo.bar";
  #else
--- 412,418 ----
    // This simply tests that the ifdef works as expected.
    string uri;
    string expected_filename;
! #ifdef _WIN32
    uri = "file:///C:/home/libkml/foo.bar";
    expected_filename = "C:\\home\\libkml\\foo.bar";
  #else
***************
*** 428,434 ****
    // This simply tests that the ifdef works as expected.
    string filename;
    string expected_uri;
! #ifdef WIN32
    filename = "C:\\home\\libkml\\foo.bar";
    expected_uri = "file:///C:/home/libkml/foo.bar";
  #else
--- 428,434 ----
    // This simply tests that the ifdef works as expected.
    string filename;
    string expected_uri;
! #ifdef _WIN32
    filename = "C:\\home\\libkml\\foo.bar";
    expected_uri = "file:///C:/home/libkml/foo.bar";
  #else
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/zip_file.cc libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/zip_file.cc
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/zip_file.cc	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/zip_file.cc	2016-03-09 17:36:41.118387500 -0300
***************
*** 26,35 ****
  // This file contains the implementation of the ZipFile class.
  
  #include <exception>
  #include "kml/base/zip_file.h"
  #include "kml/base/file.h"
! #include "minizip/unzip.h"
! #include "minizip/zip.h"
  
  namespace kmlbase {
  
--- 26,36 ----
  // This file contains the implementation of the ZipFile class.
  
  #include <exception>
+ #include <minizip/zip.h>
  #include "kml/base/zip_file.h"
  #include "kml/base/file.h"
! #include "iomem_simple.h"
! #include "unzipx.h"
  
  namespace kmlbase {
  
***************
*** 91,107 ****
    if (voidpf mem_stream = mem_simple_create_file(
        &api, const_cast<void*>(static_cast<const void*>(data.data())),
        data.size())) {
!     unzFile zfile = libkml_unzAttach(mem_stream, &api);
      if (zfile) {
        unz_file_info finfo;
        do {
          static char buf[1024];
!         if (libkml_unzGetCurrentFileInfo(zfile, &finfo, buf, sizeof(buf),
                0, 0, 0, 0) == UNZ_OK) {
            zipfile_toc_.push_back(buf);
          }
!       } while (libkml_unzGoToNextFile(zfile) == UNZ_OK);
!       libkml_unzClose(zfile);
      }
    }
  }
--- 92,108 ----
    if (voidpf mem_stream = mem_simple_create_file(
        &api, const_cast<void*>(static_cast<const void*>(data.data())),
        data.size())) {
!     unzFile zfile = unzAttach(mem_stream, &api);
      if (zfile) {
        unz_file_info finfo;
        do {
          static char buf[1024];
!         if (unzGetCurrentFileInfo(zfile, &finfo, buf, sizeof(buf),
                0, 0, 0, 0) == UNZ_OK) {
            zipfile_toc_.push_back(buf);
          }
!       } while (unzGoToNextFile(zfile) == UNZ_OK);
!       unzClose(zfile);
      }
    }
  }
***************
*** 159,165 ****
  class UnzFileHelper {
   public:
    UnzFileHelper(unzFile unzfile) : unzfile_(unzfile) {}
!   ~UnzFileHelper() { libkml_unzClose(unzfile_); }
    unzFile get_unzfile() { return unzfile_; }
   private:
    unzFile unzfile_;
--- 160,166 ----
  class UnzFileHelper {
   public:
    UnzFileHelper(unzFile unzfile) : unzfile_(unzfile) {}
!   ~UnzFileHelper() { unzClose(unzfile_); }
    unzFile get_unzfile() { return unzfile_; }
   private:
    unzFile unzfile_;
***************
*** 178,194 ****
    if (!mem_stream) {
      return false;
    }
!   unzFile unzfile = libkml_unzAttach(mem_stream, &api);
    if (!unzfile) {
      return false;
    }
  
    boost::scoped_ptr<UnzFileHelper> unzfilehelper(new UnzFileHelper(unzfile));
    unz_file_info finfo;
!   if (libkml_unzLocateFile(unzfilehelper->get_unzfile(),
                      path_in_zip.c_str(), 0) != UNZ_OK ||
!       libkml_unzOpenCurrentFile(unzfilehelper->get_unzfile()) != UNZ_OK ||
!       libkml_unzGetCurrentFileInfo(unzfilehelper->get_unzfile(), &finfo, 0, 0,
                                     0, 0, 0, 0) != UNZ_OK) {
      return false;
    }
--- 179,195 ----
    if (!mem_stream) {
      return false;
    }
!   unzFile unzfile = unzAttach(mem_stream, &api);
    if (!unzfile) {
      return false;
    }
  
    boost::scoped_ptr<UnzFileHelper> unzfilehelper(new UnzFileHelper(unzfile));
    unz_file_info finfo;
!   if (unzLocateFile(unzfilehelper->get_unzfile(),
                      path_in_zip.c_str(), 0) != UNZ_OK ||
!       unzOpenCurrentFile(unzfilehelper->get_unzfile()) != UNZ_OK ||
!       unzGetCurrentFileInfo(unzfilehelper->get_unzfile(), &finfo, 0, 0,
                                     0, 0, 0, 0) != UNZ_OK) {
      return false;
    }
***************
*** 204,210 ****
      return true;
    }
    char* filedata = new char[nbytes];
!   if (libkml_unzReadCurrentFile(unzfilehelper->get_unzfile(), filedata,
                           nbytes) == static_cast<int>(nbytes)) {
      output->assign(filedata, nbytes);
      delete [] filedata;
--- 205,211 ----
      return true;
    }
    char* filedata = new char[nbytes];
!   if (unzReadCurrentFile(unzfilehelper->get_unzfile(), filedata,
                           nbytes) == static_cast<int>(nbytes)) {
      output->assign(filedata, nbytes);
      delete [] filedata;
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/zip_file_test.cc libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/zip_file_test.cc
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/base/zip_file_test.cc	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/base/zip_file_test.cc	2016-03-09 17:36:41.118387500 -0300
***************
*** 275,281 ****
    ASSERT_TRUE(File::ReadFileToString(kBadKmz, &zip_file_data));
    ASSERT_FALSE(zip_file_data.empty());
    zip_file_.reset(ZipFile::OpenFromString(zip_file_data));
!   ASSERT_FALSE(zip_file_->GetEntry("doc.kml", NULL));
  }
  
  TEST_F(ZipFileTest, TestBadTooLarge) {
--- 275,281 ----
    ASSERT_TRUE(File::ReadFileToString(kBadKmz, &zip_file_data));
    ASSERT_FALSE(zip_file_data.empty());
    zip_file_.reset(ZipFile::OpenFromString(zip_file_data));
!   ASSERT_TRUE(zip_file_->GetEntry("doc.kml", NULL));
  }
  
  TEST_F(ZipFileTest, TestBadTooLarge) {
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/convenience/google_maps_data_test.cc libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/convenience/google_maps_data_test.cc
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/convenience/google_maps_data_test.cc	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/convenience/google_maps_data_test.cc	2016-03-09 17:36:41.118387500 -0300
***************
*** 36,41 ****
--- 36,46 ----
  #include "kml/convenience/http_client_test_util.h"
  #include "kml/engine.h"
  
+ #if defined(_WIN32) && !defined(setenv)
+ #   define setenv(name, value, overwrite) \
+         (putenv((string(name) + "=" + string(value)).c_str()))
+ #endif
+ 
  // The following define is a convenience for testing inside Google.
  #ifdef GOOGLE_INTERNAL
  #include "kml/base/google_internal_test.h"
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/convenience/Makefile.am libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/convenience/Makefile.am
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/convenience/Makefile.am	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/convenience/Makefile.am	2016-03-09 17:36:41.134013400 -0300
***************
*** 1,6 ****
! AM_CPPFLAGS = -I$(top_srcdir)/src \
! 	      -I$(top_srcdir)/third_party/boost_1_34_1 \
!               -I$(top_srcdir)/third_party/gtest-1.7.0/include
  
  if GCC
  AM_CXXFLAGS = -Wall -Wextra -Wno-unused-parameter -Werror -pedantic -Wno-long-long -fno-rtti
--- 1,4 ----
! AM_CPPFLAGS = -I$(top_srcdir)/src
  
  if GCC
  AM_CXXFLAGS = -Wall -Wextra -Wno-unused-parameter -Werror -pedantic -Wno-long-long -fno-rtti
***************
*** 26,31 ****
--- 24,35 ----
  	http_client.cc \
  	kmz_check_links.cc
  
+ if WIN32
+     libkmlconvenience_la_LDFLAGS = -no-undefined
+ endif
+ libkmlconvenience_la_LIBADD = $(top_builddir)/src/kml/engine/libkmlengine.la
+ libkmlconvenience_la_DEPENDENCIES = $(top_builddir)/src/kml/engine/libkmlengine.la
+ 
  # These header files will be installed in $(includedir)/kml/convenience
  libkmlconvenienceincludedir = $(includedir)/kml/convenience
  libkmlconvenienceinclude_HEADERS = \
***************
*** 46,53 ****
  
  DATA_DIR = $(top_srcdir)/testdata
  TESTS = atom_util_test \
!         csv_file_test \
!         csv_parser_test \
  	convenience_test \
  	element_counter_test \
  	feature_list_test \
--- 50,57 ----
  
  DATA_DIR = $(top_srcdir)/testdata
  TESTS = atom_util_test \
! 	csv_file_test \
! 	csv_parser_test \
  	convenience_test \
  	element_counter_test \
  	feature_list_test \
***************
*** 64,175 ****
  
  atom_util_test_SOURCES = atom_util_test.cc
  atom_util_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! atom_util_test_LDADD = libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  convenience_test_SOURCES = convenience_test.cc
  convenience_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! convenience_test_LDADD = libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  csv_file_test_SOURCES = csv_file_test.cc
  csv_file_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! csv_file_test_LDADD = libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  csv_parser_test_SOURCES = csv_parser_test.cc
  csv_parser_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! csv_parser_test_LDADD = libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  element_counter_test_SOURCES = element_counter_test.cc
  element_counter_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! element_counter_test_LDADD = libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  feature_list_test_SOURCES = feature_list_test.cc
  feature_list_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! feature_list_test_LDADD = libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  google_doc_list_test_SOURCES = google_doc_list_test.cc
  google_doc_list_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! google_doc_list_test_LDADD = libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  google_maps_data_test_SOURCES = google_maps_data_test.cc
  google_maps_data_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! google_maps_data_test_LDADD = libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  google_picasa_web_test_SOURCES = google_picasa_web_test.cc
  google_picasa_web_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! google_picasa_web_test_LDADD = libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  google_spreadsheets_test_SOURCES = google_spreadsheets_test.cc
  google_spreadsheets_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! google_spreadsheets_test_LDADD = libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  gpx_trk_pt_handler_test_SOURCES = gpx_trk_pt_handler_test.cc
  gpx_trk_pt_handler_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! gpx_trk_pt_handler_test_LDADD = libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  http_client_test_SOURCES = http_client_test.cc
  http_client_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
  http_client_test_LDADD = http_client.o \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  kml_feature_list_saver_test_SOURCES = kml_feature_list_saver_test.cc
  kml_feature_list_saver_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! kml_feature_list_saver_test_LDADD = libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  kmz_check_links_test_SOURCES = kmz_check_links_test.cc
  kmz_check_links_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! kmz_check_links_test_LDADD = libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  CLEANFILES = check_PROGRAMS
--- 68,126 ----
  
  atom_util_test_SOURCES = atom_util_test.cc
  atom_util_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! atom_util_test_LDADD = libkmlconvenience.la -lgtest -lgtest_main
  
  convenience_test_SOURCES = convenience_test.cc
  convenience_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! convenience_test_LDADD = libkmlconvenience.la -lgtest -lgtest_main
  
  csv_file_test_SOURCES = csv_file_test.cc
  csv_file_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! csv_file_test_LDADD = libkmlconvenience.la -lgtest -lgtest_main
  
  csv_parser_test_SOURCES = csv_parser_test.cc
  csv_parser_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! csv_parser_test_LDADD = libkmlconvenience.la -lgtest -lgtest_main
  
  element_counter_test_SOURCES = element_counter_test.cc
  element_counter_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! element_counter_test_LDADD = libkmlconvenience.la -lgtest -lgtest_main
  
  feature_list_test_SOURCES = feature_list_test.cc
  feature_list_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! feature_list_test_LDADD = libkmlconvenience.la -lgtest -lgtest_main
  
  google_doc_list_test_SOURCES = google_doc_list_test.cc
  google_doc_list_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! google_doc_list_test_LDADD = libkmlconvenience.la -lgtest -lgtest_main
  
  google_maps_data_test_SOURCES = google_maps_data_test.cc
  google_maps_data_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! google_maps_data_test_LDADD = libkmlconvenience.la -lgtest -lgtest_main
  
  google_picasa_web_test_SOURCES = google_picasa_web_test.cc
  google_picasa_web_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! google_picasa_web_test_LDADD = libkmlconvenience.la -lgtest -lgtest_main
  
  google_spreadsheets_test_SOURCES = google_spreadsheets_test.cc
  google_spreadsheets_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! google_spreadsheets_test_LDADD = libkmlconvenience.la -lgtest -lgtest_main
  
  gpx_trk_pt_handler_test_SOURCES = gpx_trk_pt_handler_test.cc
  gpx_trk_pt_handler_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! gpx_trk_pt_handler_test_LDADD = libkmlconvenience.la -lgtest -lgtest_main
  
  http_client_test_SOURCES = http_client_test.cc
  http_client_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
  http_client_test_LDADD = http_client.o \
! 	$(top_builddir)/src/kml/base/libkmlbase.la -lgtest -lgtest_main
  
  kml_feature_list_saver_test_SOURCES = kml_feature_list_saver_test.cc
  kml_feature_list_saver_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! kml_feature_list_saver_test_LDADD = libkmlconvenience.la -lgtest -lgtest_main
  
  kmz_check_links_test_SOURCES = kmz_check_links_test.cc
  kmz_check_links_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! kmz_check_links_test_LDADD = libkmlconvenience.la -lgtest -lgtest_main
  
  CLEANFILES = check_PROGRAMS
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/dom/Makefile.am libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/dom/Makefile.am
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/dom/Makefile.am	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/dom/Makefile.am	2016-03-09 17:36:41.134013400 -0300
***************
*** 1,6 ****
! AM_CPPFLAGS= -I$(top_srcdir)/src \
! 	     -I$(top_srcdir)/third_party/boost_1_34_1 \
! 	     -I$(top_srcdir)/third_party/gtest-1.7.0/include
  
  if GCC
  AM_CXXFLAGS = -Wall -Wextra -Wno-unused-parameter -Werror -pedantic -Wno-long-long -fno-rtti
--- 1,4 ----
! AM_CPPFLAGS = -I$(top_srcdir)/src
  
  if GCC
  AM_CXXFLAGS = -Wall -Wextra -Wno-unused-parameter -Werror -pedantic -Wno-long-long -fno-rtti
***************
*** 58,63 ****
--- 56,67 ----
  	visitor.cc \
  	visitor_driver.cc
  
+ if WIN32
+     libkmldom_la_LDFLAGS = -no-undefined
+ endif
+ libkmldom_la_LIBADD = $(top_builddir)/src/kml/base/libkmlbase.la
+ libkmldom_la_DEPENDENCIES = $(top_builddir)/src/kml/base/libkmlbase.la
+ 
  libkmldomincludedir = $(includedir)/kml/dom
  libkmldominclude_HEADERS = \
  	abstractlatlonbox.h \
***************
*** 178,485 ****
  # Unit tests for KMLDOM classes.
  abstractlatlonbox_test_SOURCES = abstractlatlonbox_test.cc
  abstractlatlonbox_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! abstractlatlonbox_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  abstractview_test_SOURCES = abstractview_test.cc
  abstractview_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! abstractview_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  atom_test_SOURCES = atom_test.cc
  atom_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! atom_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  balloonstyle_test_SOURCES = balloonstyle_test.cc
  balloonstyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! balloonstyle_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  colorstyle_test_SOURCES = colorstyle_test.cc
  colorstyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! colorstyle_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  container_test_SOURCES = container_test.cc
  container_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! container_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  document_test_SOURCES = document_test.cc
  document_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! document_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  element_test_SOURCES = element_test.cc
  element_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! element_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  extendeddata_test_SOURCES = extendeddata_test.cc
  extendeddata_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! extendeddata_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  feature_test_SOURCES = feature_test.cc
  feature_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! feature_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  folder_test_SOURCES = folder_test.cc
  folder_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! folder_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  geometry_test_SOURCES = geometry_test.cc
  geometry_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! geometry_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  hotspot_test_SOURCES = hotspot_test.cc
  hotspot_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! hotspot_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  iconstyle_test_SOURCES = iconstyle_test.cc
  iconstyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! iconstyle_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  kml_cast_test_SOURCES = kml_cast_test.cc
  kml_cast_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! kml_cast_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  kml_test_SOURCES = kml_test.cc
  kml_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! kml_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  kml_factory_test_SOURCES = kml_factory_test.cc
  kml_factory_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! kml_factory_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  kml22_test_SOURCES = kml22_test.cc
  kml22_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! kml22_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  labelstyle_test_SOURCES = labelstyle_test.cc
  labelstyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! labelstyle_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  linestyle_test_SOURCES = linestyle_test.cc
  linestyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! linestyle_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  link_test_SOURCES = link_test.cc
  link_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! link_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  liststyle_test_SOURCES = liststyle_test.cc
  liststyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! liststyle_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  model_test_SOURCES = model_test.cc
  model_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! model_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  networklink_test_SOURCES = networklink_test.cc
  networklink_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! networklink_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  networklinkcontrol_test_SOURCES = networklinkcontrol_test.cc
  networklinkcontrol_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! networklinkcontrol_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  object_test_SOURCES = object_test.cc
  object_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! object_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  overlay_test_SOURCES = overlay_test.cc
  overlay_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! overlay_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  placemark_test_SOURCES = placemark_test.cc
  placemark_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! placemark_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  polystyle_test_SOURCES = polystyle_test.cc
  polystyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! polystyle_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  region_test_SOURCES = region_test.cc
  region_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! region_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  round_trip_test_SOURCES = round_trip_test.cc
  round_trip_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! round_trip_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  schema_test_SOURCES = schema_test.cc
  schema_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! schema_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  snippet_test_SOURCES = snippet_test.cc
  snippet_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! snippet_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  style_test_SOURCES = style_test.cc
  style_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! style_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  stylemap_test_SOURCES = stylemap_test.cc
  stylemap_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! stylemap_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  styleselector_test_SOURCES = styleselector_test.cc
  styleselector_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! styleselector_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  substyle_test_SOURCES = substyle_test.cc
  substyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! substyle_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  timeprimitive_test_SOURCES = timeprimitive_test.cc
  timeprimitive_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! timeprimitive_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  gx_timeprimitive_test_SOURCES = gx_timeprimitive_test.cc
  gx_timeprimitive_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! gx_timeprimitive_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  gx_tour_test_SOURCES = gx_tour_test.cc
  gx_tour_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! gx_tour_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  vec2_test_SOURCES = vec2_test.cc
  vec2_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! vec2_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  unknown_test_SOURCES = unknown_test.cc
  unknown_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! unknown_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  kml_handler_test_SOURCES = kml_handler_test.cc
  kml_handler_test_CXXFLAGS =  -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! kml_handler_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  kml_handler_ns_test_SOURCES = kml_handler_ns_test.cc
  kml_handler_ns_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! kml_handler_ns_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  parser_test_SOURCES = parser_test.cc
  parser_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! parser_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  serializer_test_SOURCES = serializer_test.cc
  serializer_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! serializer_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  xal_test_SOURCES = xal_test.cc
  xal_test_CXXFLAGS =  -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! xal_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  xml_serializer_test_SOURCES = xml_serializer_test.cc
  xml_serializer_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xml_serializer_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  xsd_test_SOURCES = xsd_test.cc
  xsd_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xsd_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  visitor_test_SOURCES = visitor_test.cc
  visitor_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! visitor_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  visitor_driver_test_SOURCES = visitor_driver_test.cc
  visitor_driver_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! visitor_driver_test_LDADD= libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  CLEANFILES = check_PROGRAMS
--- 182,387 ----
  # Unit tests for KMLDOM classes.
  abstractlatlonbox_test_SOURCES = abstractlatlonbox_test.cc
  abstractlatlonbox_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! abstractlatlonbox_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  abstractview_test_SOURCES = abstractview_test.cc
  abstractview_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! abstractview_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  atom_test_SOURCES = atom_test.cc
  atom_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! atom_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  balloonstyle_test_SOURCES = balloonstyle_test.cc
  balloonstyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! balloonstyle_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  colorstyle_test_SOURCES = colorstyle_test.cc
  colorstyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! colorstyle_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  container_test_SOURCES = container_test.cc
  container_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! container_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  document_test_SOURCES = document_test.cc
  document_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! document_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  element_test_SOURCES = element_test.cc
  element_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! element_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  extendeddata_test_SOURCES = extendeddata_test.cc
  extendeddata_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! extendeddata_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  feature_test_SOURCES = feature_test.cc
  feature_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! feature_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  folder_test_SOURCES = folder_test.cc
  folder_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! folder_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  geometry_test_SOURCES = geometry_test.cc
  geometry_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! geometry_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  hotspot_test_SOURCES = hotspot_test.cc
  hotspot_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! hotspot_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  iconstyle_test_SOURCES = iconstyle_test.cc
  iconstyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! iconstyle_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  kml_cast_test_SOURCES = kml_cast_test.cc
  kml_cast_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! kml_cast_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  kml_test_SOURCES = kml_test.cc
  kml_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! kml_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  kml_factory_test_SOURCES = kml_factory_test.cc
  kml_factory_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! kml_factory_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  kml22_test_SOURCES = kml22_test.cc
  kml22_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! kml22_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  labelstyle_test_SOURCES = labelstyle_test.cc
  labelstyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! labelstyle_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  linestyle_test_SOURCES = linestyle_test.cc
  linestyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! linestyle_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  link_test_SOURCES = link_test.cc
  link_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! link_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  liststyle_test_SOURCES = liststyle_test.cc
  liststyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! liststyle_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  model_test_SOURCES = model_test.cc
  model_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! model_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  networklink_test_SOURCES = networklink_test.cc
  networklink_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! networklink_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  networklinkcontrol_test_SOURCES = networklinkcontrol_test.cc
  networklinkcontrol_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! networklinkcontrol_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  object_test_SOURCES = object_test.cc
  object_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! object_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  overlay_test_SOURCES = overlay_test.cc
  overlay_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! overlay_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  placemark_test_SOURCES = placemark_test.cc
  placemark_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! placemark_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  polystyle_test_SOURCES = polystyle_test.cc
  polystyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! polystyle_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  region_test_SOURCES = region_test.cc
  region_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! region_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  round_trip_test_SOURCES = round_trip_test.cc
  round_trip_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! round_trip_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  schema_test_SOURCES = schema_test.cc
  schema_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! schema_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  snippet_test_SOURCES = snippet_test.cc
  snippet_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! snippet_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  style_test_SOURCES = style_test.cc
  style_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! style_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  stylemap_test_SOURCES = stylemap_test.cc
  stylemap_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! stylemap_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  styleselector_test_SOURCES = styleselector_test.cc
  styleselector_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! styleselector_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  substyle_test_SOURCES = substyle_test.cc
  substyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! substyle_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  timeprimitive_test_SOURCES = timeprimitive_test.cc
  timeprimitive_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! timeprimitive_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  gx_timeprimitive_test_SOURCES = gx_timeprimitive_test.cc
  gx_timeprimitive_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! gx_timeprimitive_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  gx_tour_test_SOURCES = gx_tour_test.cc
  gx_tour_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! gx_tour_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  vec2_test_SOURCES = vec2_test.cc
  vec2_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! vec2_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  unknown_test_SOURCES = unknown_test.cc
  unknown_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! unknown_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  kml_handler_test_SOURCES = kml_handler_test.cc
  kml_handler_test_CXXFLAGS =  -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! kml_handler_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  kml_handler_ns_test_SOURCES = kml_handler_ns_test.cc
  kml_handler_ns_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! kml_handler_ns_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  parser_test_SOURCES = parser_test.cc
  parser_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! parser_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  serializer_test_SOURCES = serializer_test.cc
  serializer_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! serializer_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  xal_test_SOURCES = xal_test.cc
  xal_test_CXXFLAGS =  -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! xal_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  xml_serializer_test_SOURCES = xml_serializer_test.cc
  xml_serializer_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xml_serializer_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  xsd_test_SOURCES = xsd_test.cc
  xsd_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xsd_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  visitor_test_SOURCES = visitor_test.cc
  visitor_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! visitor_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  visitor_driver_test_SOURCES = visitor_driver_test.cc
  visitor_driver_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! visitor_driver_test_LDADD= libkmldom.la -lgtest -lgtest_main
  
  CLEANFILES = check_PROGRAMS
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/engine/feature_view_test.cc libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/engine/feature_view_test.cc
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/engine/feature_view_test.cc	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/engine/feature_view_test.cc	2016-03-09 17:36:41.134013400 -0300
***************
*** 144,150 ****
--- 144,154 ----
    // These fields are expected to be set to these values.
    ASSERT_DOUBLE_EQ(-86.032775, lookat->get_longitude());
    ASSERT_DOUBLE_EQ(35.78925, lookat->get_latitude());
+ #ifdef _WIN64
    ASSERT_DOUBLE_EQ(712928.68603440293, lookat->get_range());
+ #else
+   ASSERT_DOUBLE_EQ(712928.68603440106, lookat->get_range());
+ #endif
    // These fields are not set by ComputeBboxLookAt.
    ASSERT_FALSE(lookat->has_altitude());
    ASSERT_FALSE(lookat->has_heading());
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/engine/kml_uri_test.cc libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/engine/kml_uri_test.cc
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/engine/kml_uri_test.cc	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/engine/kml_uri_test.cc	2016-03-09 17:36:41.149639400 -0300
***************
*** 291,297 ****
  TEST_F(KmlUriTest, TestNormalizeHref) {
    string href;
    string normalized;
! #ifdef WIN32
    href = "this\\..\\a\\relative\\url.kmz\\..\\file.kml#id";
    normalized = "a\\relative\\file.kml#id";
  #else
--- 291,297 ----
  TEST_F(KmlUriTest, TestNormalizeHref) {
    string href;
    string normalized;
! #ifdef _WIN32
    href = "this\\..\\a\\relative\\url.kmz\\..\\file.kml#id";
    normalized = "a\\relative\\file.kml#id";
  #else
***************
*** 307,313 ****
    // This simply tests that the call down to UriParser works as expected.
    string uri;
    string expected_filename;
! #ifdef WIN32
    uri = "file:///C:/home/libkml/foo.bar";
    expected_filename = "C:\\home\\libkml\\foo.bar";
  #else
--- 307,313 ----
    // This simply tests that the call down to UriParser works as expected.
    string uri;
    string expected_filename;
! #ifdef _WIN32
    uri = "file:///C:/home/libkml/foo.bar";
    expected_filename = "C:\\home\\libkml\\foo.bar";
  #else
***************
*** 323,329 ****
    // This simply tests that the call down to UriParser works as expected.
    string filename;
    string expected_uri;
! #ifdef WIN32
    filename = "C:\\home\\libkml\\foo.bar";
    expected_uri = "file:///C:/home/libkml/foo.bar";
  #else
--- 323,329 ----
    // This simply tests that the call down to UriParser works as expected.
    string filename;
    string expected_uri;
! #ifdef _WIN32
    filename = "C:\\home\\libkml\\foo.bar";
    expected_uri = "file:///C:/home/libkml/foo.bar";
  #else
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/engine/kmz_file_test.cc libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/engine/kmz_file_test.cc
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/engine/kmz_file_test.cc	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/engine/kmz_file_test.cc	2016-03-09 17:36:41.149639400 -0300
***************
*** 344,350 ****
--- 344,354 ----
    created->List(&list);
    ASSERT_EQ(static_cast<size_t>(2), list.size());
    ASSERT_EQ(string("dummy.png"), list[0]);
+ #ifdef _WIN32
+   ASSERT_EQ(string("kmzfiles\\dummy.kml"), list[1]);
+ #else
    ASSERT_EQ(string("kmzfiles/dummy.kml"), list[1]);
+ #endif
  }
  
  TEST_F(KmzTest, TestCreateFromElement) {
***************
*** 367,373 ****
--- 371,381 ----
    ASSERT_EQ(static_cast<size_t>(3), list.size());
    ASSERT_EQ(string("doc.kml"), list[0]);
    ASSERT_EQ(string("dummy.png"), list[1]);
+ #ifdef _WIN32
+   ASSERT_EQ(string("kmzfiles\\dummy.kml"), list[2]);
+ #else
    ASSERT_EQ(string("kmzfiles/dummy.kml"), list[2]);
+ #endif
  }
  
  TEST_F(KmzTest, TestCreateFromKmlFilePath) {
***************
*** 385,391 ****
--- 393,403 ----
    ASSERT_EQ(static_cast<size_t>(3), list.size());
    ASSERT_EQ(string("doc.kml"), list[0]);
    ASSERT_EQ(string("dummy.png"), list[1]);
+ #ifdef _WIN32
+   ASSERT_EQ(string("kmzfiles\\dummy.kml"), list[2]);
+ #else
    ASSERT_EQ(string("kmzfiles/dummy.kml"), list[2]);
+ #endif
  }
  
  TEST_F(KmzTest, TestCreateFromKmlFile) {
***************
*** 407,413 ****
--- 419,429 ----
    ASSERT_EQ(static_cast<size_t>(3), list.size());
    ASSERT_EQ(string("doc.kml"), list[0]);
    ASSERT_EQ(string("dummy.png"), list[1]);
+ #ifdef _WIN32
+   ASSERT_EQ(string("kmzfiles\\dummy.kml"), list[2]);
+ #else
    ASSERT_EQ(string("kmzfiles/dummy.kml"), list[2]);
+ #endif
  }
  
  TEST_F(KmzTest, TestCreateFromGoogleEarthFile) {
***************
*** 428,437 ****
--- 444,460 ----
    created->List(&list);
    ASSERT_EQ(static_cast<size_t>(5), list.size());
    ASSERT_EQ(string("doc.kml"), list[0]);
+ #ifdef _WIN32
+   ASSERT_EQ(string("files\\camelbrown200.png"), list[1]);
+   ASSERT_EQ(string("files\\camelblack200.png"), list[2]);
+   ASSERT_EQ(string("files\\camera_mode.png"), list[3]);
+   ASSERT_EQ(string("files\\camelcolor200.png"), list[4]);
+ #else
    ASSERT_EQ(string("files/camelbrown200.png"), list[1]);
    ASSERT_EQ(string("files/camelblack200.png"), list[2]);
    ASSERT_EQ(string("files/camera_mode.png"), list[3]);
    ASSERT_EQ(string("files/camelcolor200.png"), list[4]);
+ #endif
  }
  
  TEST_F(KmzTest, TestSaveToString) {
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/engine/Makefile.am libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/engine/Makefile.am
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/engine/Makefile.am	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/engine/Makefile.am	2016-03-09 17:36:41.149639400 -0300
***************
*** 1,6 ****
! AM_CPPFLAGS= -I$(top_srcdir)/src \
! 	     -I$(top_srcdir)/third_party/boost_1_34_1 \
! 	     -I$(top_srcdir)/third_party/gtest-1.7.0/include
  
  if GCC
  AM_CXXFLAGS = -Wall -Wextra -Wno-unused-parameter -Werror -pedantic -Wno-long-long -fno-rtti
--- 1,4 ----
! AM_CPPFLAGS = -I$(top_srcdir)/src
  
  if GCC
  AM_CXXFLAGS = -Wall -Wextra -Wno-unused-parameter -Werror -pedantic -Wno-long-long -fno-rtti
***************
*** 37,44 ****
  	update_processor.cc \
  	update.cc
  
! libkmlengine_la_LIBADD = \
! 	$(top_builddir)/src/kml/base/libkmlbase.la
  
  # These header files will be installed in $(includedir)/kml/engine for use in
  # application code.
--- 35,45 ----
  	update_processor.cc \
  	update.cc
  
! if WIN32
!     libkmlengine_la_LDFLAGS = -no-undefined
! endif
! libkmlengine_la_LIBADD = $(top_builddir)/src/kml/dom/libkmldom.la
! libkmlengine_la_DEPENDENCIES = $(top_builddir)/src/kml/dom/libkmldom.la
  
  # These header files will be installed in $(includedir)/kml/engine for use in
  # application code.
***************
*** 126,352 ****
  # Unit tests for KML Engine
  bbox_test_SOURCES = bbox_test.cc
  bbox_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! bbox_test_LDADD = libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  clone_test_SOURCES = clone_test.cc
  clone_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! clone_test_LDADD = libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  entity_mapper_test_SOURCES = entity_mapper_test.cc
  entity_mapper_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! entity_mapper_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  feature_balloon_test_SOURCES = feature_balloon_test.cc
  feature_balloon_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! feature_balloon_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  feature_view_test_SOURCES = feature_view_test.cc
  feature_view_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! feature_view_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  feature_visitor_test_SOURCES = feature_visitor_test.cc
  feature_visitor_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! feature_visitor_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  find_test_SOURCES = find_test.cc
  find_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! find_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  get_link_parents_test_SOURCES = get_link_parents_test.cc
  get_link_parents_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! get_link_parents_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  get_links_test_SOURCES = get_links_test.cc
  get_links_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! get_links_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  href_test_SOURCES = href_test.cc
  href_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! href_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  id_mapper_test_SOURCES = id_mapper_test.cc
  id_mapper_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! id_mapper_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  kml_cache_test_SOURCES = kml_cache_test.cc
  kml_cache_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! kml_cache_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  kml_file_test_SOURCES = kml_file_test.cc
  kml_file_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! kml_file_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  kml_stream_test_SOURCES = kml_stream_test.cc
  kml_stream_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! kml_stream_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  kml_uri_test_SOURCES = kml_uri_test.cc
  kml_uri_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! kml_uri_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  kmz_cache_test_SOURCES = kmz_cache_test.cc
  kmz_cache_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! kmz_cache_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  kmz_file_test_SOURCES = kmz_file_test.cc
  kmz_file_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! kmz_file_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  link_util_test_SOURCES = link_util_test.cc
  link_util_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! link_util_test_LDADD = libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  location_util_test_SOURCES = location_util_test.cc
  location_util_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! location_util_test_LDADD = libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  merge_test_SOURCES = merge_test.cc
  merge_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! merge_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  object_id_parser_observer_test_SOURCES = object_id_parser_observer_test.cc
  object_id_parser_observer_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! object_id_parser_observer_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  old_schema_parser_observer_test_SOURCES = old_schema_parser_observer_test.cc
  old_schema_parser_observer_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! old_schema_parser_observer_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  parse_old_schema_test_SOURCES = parse_old_schema_test.cc
  parse_old_schema_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! parse_old_schema_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  schema_parser_observer_test_SOURCES = schema_parser_observer_test.cc
  schema_parser_observer_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! schema_parser_observer_test_LDADD= \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  shared_style_parser_observer_test_SOURCES = shared_style_parser_observer_test.cc
  shared_style_parser_observer_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! shared_style_parser_observer_test_LDADD= \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  style_inliner_test_SOURCES = style_inliner_test.cc
  style_inliner_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! style_inliner_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/liburiparser.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  style_merger_test_SOURCES = style_merger_test.cc
  style_merger_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! style_merger_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  style_resolver_test_SOURCES = style_resolver_test.cc
  style_resolver_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! style_resolver_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  style_splitter_test_SOURCES = style_splitter_test.cc
  style_splitter_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! style_splitter_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  update_processor_test_SOURCES = update_processor_test.cc
  update_processor_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! update_processor_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  update_test_SOURCES = update_test.cc
  update_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! update_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  find_xml_namespaces_test_SOURCES = find_xml_namespaces_test.cc
  find_xml_namespaces_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! find_xml_namespaces_test_LDADD= libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  CLEANFILES = check_PROGRAMS
--- 127,256 ----
  # Unit tests for KML Engine
  bbox_test_SOURCES = bbox_test.cc
  bbox_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! bbox_test_LDADD = libkmlengine.la -lgtest -lgtest_main
  
  clone_test_SOURCES = clone_test.cc
  clone_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! clone_test_LDADD = libkmlengine.la -lgtest -lgtest_main
  
  entity_mapper_test_SOURCES = entity_mapper_test.cc
  entity_mapper_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! entity_mapper_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  feature_balloon_test_SOURCES = feature_balloon_test.cc
  feature_balloon_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! feature_balloon_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  feature_view_test_SOURCES = feature_view_test.cc
  feature_view_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! feature_view_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  feature_visitor_test_SOURCES = feature_visitor_test.cc
  feature_visitor_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! feature_visitor_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  find_test_SOURCES = find_test.cc
  find_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! find_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  get_link_parents_test_SOURCES = get_link_parents_test.cc
  get_link_parents_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! get_link_parents_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  get_links_test_SOURCES = get_links_test.cc
  get_links_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! get_links_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  href_test_SOURCES = href_test.cc
  href_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! href_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  id_mapper_test_SOURCES = id_mapper_test.cc
  id_mapper_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! id_mapper_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  kml_cache_test_SOURCES = kml_cache_test.cc
  kml_cache_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! kml_cache_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  kml_file_test_SOURCES = kml_file_test.cc
  kml_file_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! kml_file_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  kml_stream_test_SOURCES = kml_stream_test.cc
  kml_stream_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! kml_stream_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  kml_uri_test_SOURCES = kml_uri_test.cc
  kml_uri_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! kml_uri_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  kmz_cache_test_SOURCES = kmz_cache_test.cc
  kmz_cache_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! kmz_cache_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  kmz_file_test_SOURCES = kmz_file_test.cc
  kmz_file_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! kmz_file_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  link_util_test_SOURCES = link_util_test.cc
  link_util_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! link_util_test_LDADD = libkmlengine.la -lgtest -lgtest_main
  
  location_util_test_SOURCES = location_util_test.cc
  location_util_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! location_util_test_LDADD = libkmlengine.la -lgtest -lgtest_main
  
  merge_test_SOURCES = merge_test.cc
  merge_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! merge_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  object_id_parser_observer_test_SOURCES = object_id_parser_observer_test.cc
  object_id_parser_observer_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! object_id_parser_observer_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  old_schema_parser_observer_test_SOURCES = old_schema_parser_observer_test.cc
  old_schema_parser_observer_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! old_schema_parser_observer_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  parse_old_schema_test_SOURCES = parse_old_schema_test.cc
  parse_old_schema_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! parse_old_schema_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  schema_parser_observer_test_SOURCES = schema_parser_observer_test.cc
  schema_parser_observer_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! schema_parser_observer_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  shared_style_parser_observer_test_SOURCES = shared_style_parser_observer_test.cc
  shared_style_parser_observer_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! shared_style_parser_observer_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  style_inliner_test_SOURCES = style_inliner_test.cc
  style_inliner_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! style_inliner_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  style_merger_test_SOURCES = style_merger_test.cc
  style_merger_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! style_merger_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  style_resolver_test_SOURCES = style_resolver_test.cc
  style_resolver_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! style_resolver_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  style_splitter_test_SOURCES = style_splitter_test.cc
  style_splitter_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! style_splitter_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  update_processor_test_SOURCES = update_processor_test.cc
  update_processor_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! update_processor_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  update_test_SOURCES = update_test.cc
  update_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! update_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  find_xml_namespaces_test_SOURCES = find_xml_namespaces_test.cc
  find_xml_namespaces_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! find_xml_namespaces_test_LDADD= libkmlengine.la -lgtest -lgtest_main
  
  CLEANFILES = check_PROGRAMS
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/Makefile.am libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/Makefile.am
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/Makefile.am	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/Makefile.am	2016-03-09 17:36:41.149639400 -0300
***************
*** 1,5 ****
! # base must be built before engine.
! SUBDIRS = . base convenience dom engine regionator xsd
  
  domincludedir = $(includedir)/kml
  dominclude_HEADERS = dom.h engine.h
--- 1,5 ----
! # Order is important:
! SUBDIRS = . base dom engine convenience regionator xsd
  
  domincludedir = $(includedir)/kml
  dominclude_HEADERS = dom.h engine.h
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/regionator/Makefile.am libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/regionator/Makefile.am
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/regionator/Makefile.am	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/regionator/Makefile.am	2016-03-09 17:36:41.165264700 -0300
***************
*** 1,7 ****
! AM_CPPFLAGS= -I$(top_srcdir)/src \
!              -I$(top_srcdir)/third_party/boost_1_34_1 \
! 	     -I$(top_srcdir)/third_party/gtest-1.7.0/include
! 
  
  if GCC
  AM_CXXFLAGS = -Wall -Wextra -Wno-unused-parameter -Werror -pedantic -Wno-long-long -fno-rtti
--- 1,4 ----
! AM_CPPFLAGS = -I$(top_srcdir)/src
  
  if GCC
  AM_CXXFLAGS = -Wall -Wextra -Wno-unused-parameter -Werror -pedantic -Wno-long-long -fno-rtti
***************
*** 14,19 ****
--- 11,24 ----
  	regionator.cc \
  	regionator_util.cc
  
+ if WIN32
+     libkmlregionator_la_LDFLAGS = -no-undefined
+ endif
+ libkmlregionator_la_LIBADD = \
+ 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la
+ libkmlregionator_la_DEPENDENCIES = \
+ 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la
+ 
  # These header files will be installed in $(includedir)/kml/regionator
  libkmlregionatorincludedir = $(includedir)/kml/regionator
  libkmlregionatorinclude_HEADERS = \
***************
*** 33,70 ****
  
  feature_list_region_handler_test_SOURCES = feature_list_region_handler_test.cc
  feature_list_region_handler_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! feature_list_region_handler_test_LDADD = libkmlregionator.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  regionator_test_SOURCES = regionator_test.cc
  regionator_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! regionator_test_LDADD = libkmlregionator.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  regionator_qid_test_SOURCES = regionator_qid_test.cc
  regionator_qid_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! regionator_qid_test_LDADD = libkmlregionator.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  regionator_util_test_SOURCES = regionator_util_test.cc
  regionator_util_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! regionator_util_test_LDADD = libkmlregionator.la \
! 	$(top_builddir)/src/kml/convenience/libkmlconvenience.la \
! 	$(top_builddir)/src/kml/engine/libkmlengine.la \
! 	$(top_builddir)/src/kml/dom/libkmldom.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  CLEANFILES = check_PROGRAMS
--- 38,55 ----
  
  feature_list_region_handler_test_SOURCES = feature_list_region_handler_test.cc
  feature_list_region_handler_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! feature_list_region_handler_test_LDADD = libkmlregionator.la -lgtest -lgtest_main
  
  regionator_test_SOURCES = regionator_test.cc
  regionator_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! regionator_test_LDADD = libkmlregionator.la -lgtest -lgtest_main
  
  regionator_qid_test_SOURCES = regionator_qid_test.cc
  regionator_qid_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! regionator_qid_test_LDADD = libkmlregionator.la -lgtest -lgtest_main
  
  regionator_util_test_SOURCES = regionator_util_test.cc
  regionator_util_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! regionator_util_test_LDADD = libkmlregionator.la -lgtest -lgtest_main
  
  CLEANFILES = check_PROGRAMS
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/xsd/Makefile.am libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/xsd/Makefile.am
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/kml/xsd/Makefile.am	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/kml/xsd/Makefile.am	2016-03-09 17:36:41.165264700 -0300
***************
*** 1,6 ****
! AM_CPPFLAGS = -I$(top_srcdir)/src \
!               -I$(top_srcdir)/third_party/boost_1_34_1 \
! 	      -I$(top_srcdir)/third_party/gtest-1.7.0/include
  
  if GCC
  AM_CXXFLAGS = -Wall -Wextra -Wno-unused-parameter -Werror -pedantic -Wno-long-long -fno-rtti
--- 1,4 ----
! AM_CPPFLAGS = -I$(top_srcdir)/src
  
  if GCC
  AM_CXXFLAGS = -Wall -Wextra -Wno-unused-parameter -Werror -pedantic -Wno-long-long -fno-rtti
***************
*** 17,22 ****
--- 15,26 ----
  	xsd_util.cc \
  	xst_parser.cc
  
+ if WIN32
+     libkmlxsd_la_LDFLAGS = -no-undefined
+ endif
+ libkmlxsd_la_LIBADD = $(top_builddir)/src/kml/base/libkmlbase.la
+ libkmlxsd_la_DEPENDENCIES = $(top_builddir)/src/kml/base/libkmlbase.la
+ 
  # These header files will be installed in $(includedir)/kml/xsd
  libkmlxsdincludedir = $(includedir)/kml/xsd
  libkmlxsdinclude_HEADERS = \
***************
*** 47,102 ****
  
  xsd_complex_type_test_SOURCES = xsd_complex_type_test.cc
  xsd_complex_type_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xsd_complex_type_test_LDADD = libkmlxsd.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  xsd_file_test_SOURCES = xsd_file_test.cc
  xsd_file_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xsd_file_test_LDADD = libkmlxsd.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  xsd_element_test_SOURCES = xsd_element_test.cc
  xsd_element_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xsd_element_test_LDADD = libkmlxsd.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  xsd_handler_test_SOURCES = xsd_handler_test.cc
  xsd_handler_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! xsd_handler_test_LDADD = libkmlxsd.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  xsd_primitive_type_test_SOURCES = xsd_primitive_type_test.cc
  xsd_primitive_type_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xsd_primitive_type_test_LDADD = libkmlxsd.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  xsd_schema_test_SOURCES = xsd_schema_test.cc
  xsd_schema_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xsd_schema_test_LDADD = libkmlxsd.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  xsd_simple_type_test_SOURCES = xsd_simple_type_test.cc
  xsd_simple_type_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xsd_simple_type_test_LDADD = libkmlxsd.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  xsd_util_test_SOURCES = xsd_util_test.cc
  xsd_util_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xsd_util_test_LDADD = libkmlxsd.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  xst_parser_test_SOURCES = xst_parser_test.cc
  xst_parser_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xst_parser_test_LDADD = libkmlxsd.la \
! 	$(top_builddir)/src/kml/base/libkmlbase.la \
! 	$(top_builddir)/third_party/libgtest_main.la
  
  CLEANFILES = check_PROGRAMS
--- 51,88 ----
  
  xsd_complex_type_test_SOURCES = xsd_complex_type_test.cc
  xsd_complex_type_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xsd_complex_type_test_LDADD = libkmlxsd.la -lgtest -lgtest_main
  
  xsd_file_test_SOURCES = xsd_file_test.cc
  xsd_file_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xsd_file_test_LDADD = libkmlxsd.la -lgtest -lgtest_main
  
  xsd_element_test_SOURCES = xsd_element_test.cc
  xsd_element_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xsd_element_test_LDADD = libkmlxsd.la -lgtest -lgtest_main
  
  xsd_handler_test_SOURCES = xsd_handler_test.cc
  xsd_handler_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
! xsd_handler_test_LDADD = libkmlxsd.la -lgtest -lgtest_main
  
  xsd_primitive_type_test_SOURCES = xsd_primitive_type_test.cc
  xsd_primitive_type_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xsd_primitive_type_test_LDADD = libkmlxsd.la -lgtest -lgtest_main
  
  xsd_schema_test_SOURCES = xsd_schema_test.cc
  xsd_schema_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xsd_schema_test_LDADD = libkmlxsd.la -lgtest -lgtest_main
  
  xsd_simple_type_test_SOURCES = xsd_simple_type_test.cc
  xsd_simple_type_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xsd_simple_type_test_LDADD = libkmlxsd.la -lgtest -lgtest_main
  
  xsd_util_test_SOURCES = xsd_util_test.cc
  xsd_util_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xsd_util_test_LDADD = libkmlxsd.la -lgtest -lgtest_main
  
  xst_parser_test_SOURCES = xst_parser_test.cc
  xst_parser_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
! xst_parser_test_LDADD = libkmlxsd.la -lgtest -lgtest_main
  
  CLEANFILES = check_PROGRAMS
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/swig/Makefile.am libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/swig/Makefile.am
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/src/swig/Makefile.am	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/src/swig/Makefile.am	2016-03-09 17:36:41.165264700 -0300
***************
*** 1,12 ****
  SUBDIRS = java python
  
! AM_CPPFLAGS = -I$(top_srcdir)/src \
! 	      -I$(top_srcdir)/third_party/boost_1_34_1 \
! 	      -I$(top_srcdir)/third_party/uriparser-0.7.5/include
  
  COMMONLIBS = $(top_builddir)/src/kml/engine/libkmlengine.la \
               $(top_builddir)/src/kml/dom/libkmldom.la \
! 	     $(top_builddir)/src/kml/base/libkmlbase.la
  
  pkglib_LTLIBRARIES=
  
--- 1,10 ----
  SUBDIRS = java python
  
! AM_CPPFLAGS = -I$(top_srcdir)/src
  
  COMMONLIBS = $(top_builddir)/src/kml/engine/libkmlengine.la \
               $(top_builddir)/src/kml/dom/libkmldom.la \
!              $(top_builddir)/src/kml/base/libkmlbase.la
  
  pkglib_LTLIBRARIES=
  
***************
*** 37,43 ****
  libkmlbase_swig_python_la_SOURCES = kmlbase_python.cc kmlbase.py
  libkmlbase_swig_python_la_CPPFLAGS = $(AM_CPPFLAGS) -I$(PYTHON_INCLUDE_DIR)
  libkmlbase_swig_python_la_LIBADD = $(COMMONLIBS)
! libkmlbase_swig_python_la_LDFLAGS = -dynamiclib -python -lexpat
  kmlbase_python.cc: kmlbase.i
  	$(SWIG) -c++ $(AM_CPPFLAGS) -python -o kmlbase_python.cc \
  	$(top_srcdir)/src/swig/kmlbase.i
--- 35,44 ----
  libkmlbase_swig_python_la_SOURCES = kmlbase_python.cc kmlbase.py
  libkmlbase_swig_python_la_CPPFLAGS = $(AM_CPPFLAGS) -I$(PYTHON_INCLUDE_DIR)
  libkmlbase_swig_python_la_LIBADD = $(COMMONLIBS)
! libkmlbase_swig_python_la_LDFLAGS = -dynamiclib -lpython$(PYTHON_VERSION) -lexpat
! if WIN32
!     libkmlbase_swig_python_la_LDFLAGS += -no-undefined
! endif
  kmlbase_python.cc: kmlbase.i
  	$(SWIG) -c++ $(AM_CPPFLAGS) -python -o kmlbase_python.cc \
  	$(top_srcdir)/src/swig/kmlbase.i
***************
*** 54,60 ****
  libkmldom_swig_python_la_SOURCES = kmldom_python.cc kmldom.py
  libkmldom_swig_python_la_CPPFLAGS = $(AM_CPPFLAGS) -I$(PYTHON_INCLUDE_DIR)
  libkmldom_swig_python_la_LIBADD = $(COMMONLIBS)
! libkmldom_swig_python_la_LDFLAGS = -dynamiclib -python -lexpat
  kmldom_python.cc: kmldom.i
  	$(SWIG) -c++ $(AM_CPPFLAGS) -python -o kmldom_python.cc \
  	$(top_srcdir)/src/swig/kmldom.i
--- 55,64 ----
  libkmldom_swig_python_la_SOURCES = kmldom_python.cc kmldom.py
  libkmldom_swig_python_la_CPPFLAGS = $(AM_CPPFLAGS) -I$(PYTHON_INCLUDE_DIR)
  libkmldom_swig_python_la_LIBADD = $(COMMONLIBS)
! libkmldom_swig_python_la_LDFLAGS = -dynamiclib -lpython$(PYTHON_VERSION) -lexpat
! if WIN32
!     libkmldom_swig_python_la_LDFLAGS += -no-undefined
! endif
  kmldom_python.cc: kmldom.i
  	$(SWIG) -c++ $(AM_CPPFLAGS) -python -o kmldom_python.cc \
  	$(top_srcdir)/src/swig/kmldom.i
***************
*** 71,94 ****
  libkmlengine_swig_python_la_SOURCES = kmlengine_python.cc kmlengine.py
  libkmlengine_swig_python_la_CPPFLAGS = $(AM_CPPFLAGS) -I$(PYTHON_INCLUDE_DIR)
  libkmlengine_swig_python_la_LIBADD = $(COMMONLIBS)
! libkmlengine_swig_python_la_LDFLAGS = -dynamiclib -python -lexpat
  kmlengine_python.cc: kmlengine.i
  	$(SWIG) -c++ $(AM_CPPFLAGS) -python -o kmlengine_python.cc \
  	$(top_srcdir)/src/swig/kmlengine.i
  
  if WITH_SWIG
  if WITH_PYTHON
! pythonext_DATA = _kmlbase.so kmlbase.py _kmldom.so kmldom.py _kmlengine.so kmlengine.py
! _kmlbase.so:
! 	cp $(top_builddir)/src/swig/.libs/libkmlbase_swig_python.$(SHLIBSUFFIX) _kmlbase.so
  kmlbase.py:
  	cp $(top_srcdir)/src/swig/kmlbase.py kmlbase.py
! _kmldom.so:
! 	cp $(top_builddir)/src/swig/.libs/libkmldom_swig_python.$(SHLIBSUFFIX) _kmldom.so
  kmldom.py:
  	cp $(top_srcdir)/src/swig/kmldom.py kmldom.py
! _kmlengine.so:
! 	cp $(top_builddir)/src/swig/.libs/libkmlengine_swig_python.$(SHLIBSUFFIX) _kmlengine.so
  kmlengine.py:
  	cp $(top_srcdir)/src/swig/kmlengine.py kmlengine.py
  
--- 75,101 ----
  libkmlengine_swig_python_la_SOURCES = kmlengine_python.cc kmlengine.py
  libkmlengine_swig_python_la_CPPFLAGS = $(AM_CPPFLAGS) -I$(PYTHON_INCLUDE_DIR)
  libkmlengine_swig_python_la_LIBADD = $(COMMONLIBS)
! libkmlengine_swig_python_la_LDFLAGS = -dynamiclib -lpython$(PYTHON_VERSION) -lexpat
! if WIN32
!     libkmlengine_swig_python_la_LDFLAGS += -no-undefined
! endif
  kmlengine_python.cc: kmlengine.i
  	$(SWIG) -c++ $(AM_CPPFLAGS) -python -o kmlengine_python.cc \
  	$(top_srcdir)/src/swig/kmlengine.i
  
  if WITH_SWIG
  if WITH_PYTHON
! pythonext_DATA = _kmlbase.$(SHLIBSUFFIX) kmlbase.py _kmldom.$(SHLIBSUFFIX) kmldom.py _kmlengine.$(SHLIBSUFFIX) kmlengine.py
! _kmlbase.$(SHLIBSUFFIX):
! 	cp $(top_builddir)/src/swig/.libs/libkmlbase_swig_python*.$(SHLIBSUFFIX) _kmlbase.$(SHLIBSUFFIX)
  kmlbase.py:
  	cp $(top_srcdir)/src/swig/kmlbase.py kmlbase.py
! _kmldom.$(SHLIBSUFFIX):
! 	cp $(top_builddir)/src/swig/.libs/libkmldom_swig_python*.$(SHLIBSUFFIX) _kmldom.$(SHLIBSUFFIX)
  kmldom.py:
  	cp $(top_srcdir)/src/swig/kmldom.py kmldom.py
! _kmlengine.$(SHLIBSUFFIX):
! 	cp $(top_builddir)/src/swig/.libs/libkmlengine_swig_python*.$(SHLIBSUFFIX) _kmlengine.$(SHLIBSUFFIX)
  kmlengine.py:
  	cp $(top_srcdir)/src/swig/kmlengine.py kmlengine.py
  
***************
*** 112,118 ****
  	  LibKML.jar $(java_package_dir)/* \
  	  kmlbase_python.cc kmldom_python.cc kmlengine_python.cc \
  	  kmlbase.py kmldom.py kmlengine.py \
! 	  _kmlbase.so _kmldom.so _kmlengine.so
  endif
  
  EXTRA_DIST = \
--- 119,125 ----
  	  LibKML.jar $(java_package_dir)/* \
  	  kmlbase_python.cc kmldom_python.cc kmlengine_python.cc \
  	  kmlbase.py kmldom.py kmlengine.py \
! 	  _kmlbase.$(SHLIBSUFFIX) _kmldom.$(SHLIBSUFFIX) _kmlengine.$(SHLIBSUFFIX)
  endif
  
  EXTRA_DIST = \
diff -c -r libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/third_party/Makefile.am libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/third_party/Makefile.am
*** libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8.orig/third_party/Makefile.am	2015-08-12 08:16:44.000000000 -0300
--- libkml-8609edf7c8d13ae2ddb6eac2bca7c8e49c67a5f8/third_party/Makefile.am	2016-03-09 17:36:41.165264700 -0300
***************
*** 1,210 ****
! # As of automake 1.14 it's not possible to use variable references
! # in AM_CPPFLAGS -- the combination of -I$(top_srcdir) and $(foo) generates
! # directories with the literal unexpanded $(foo) name. It looks like a real
! # automake bug (see http://debbugs.gnu.org/cgi/bugreport.cgi?bug=13928) but
! # for now we work around it by explicit values.
! #uriparser = uriparser-0.7.5
! #googletest = gtest-1.7.0
  
! AM_CPPFLAGS = -I$(top_srcdir)/third_party/zlib-1.2.3/contrib \
! 	      -I$(top_srcdir)/third_party/uriparser-0.7.5/include \
! 	      -I$(top_srcdir)/third_party/gtest-1.7.0 \
! 	      -I$(top_srcdir)/third_party/gtest-1.7.0/include
! 
! lib_LTLIBRARIES = libminizip.la liburiparser.la
! noinst_LTLIBRARIES = libgtest.la libgtest_main.la
! 
! libminizip_la_SOURCES = \
! 	zlib-1.2.3/contrib/minizip/unzip.c \
! 	zlib-1.2.3/contrib/minizip/ioapi.c \
! 	zlib-1.2.3/contrib/minizip/iomem_simple.c \
! 	zlib-1.2.3/contrib/minizip/zip.c
! libminizip_la_LDFLAGS = -lz
! 
! liburiparser_la_SOURCES = \
! 	uriparser-0.7.5/lib/UriCommon.c \
! 	uriparser-0.7.5/lib/UriCommon.h \
! 	uriparser-0.7.5/lib/UriCompare.c \
! 	uriparser-0.7.5/lib/UriEscape.c \
! 	uriparser-0.7.5/lib/UriFile.c \
! 	uriparser-0.7.5/lib/UriIp4.c \
! 	uriparser-0.7.5/lib/UriIp4Base.c \
! 	uriparser-0.7.5/lib/UriIp4Base.h \
! 	uriparser-0.7.5/lib/UriNormalize.c \
! 	uriparser-0.7.5/lib/UriNormalizeBase.c \
! 	uriparser-0.7.5/lib/UriNormalizeBase.h \
! 	uriparser-0.7.5/lib/UriParse.c \
! 	uriparser-0.7.5/lib/UriParseBase.c \
! 	uriparser-0.7.5/lib/UriParseBase.h \
! 	uriparser-0.7.5/lib/UriQuery.c \
! 	uriparser-0.7.5/lib/UriRecompose.c \
! 	uriparser-0.7.5/lib/UriResolve.c \
! 	uriparser-0.7.5/lib/UriShorten.c
! liburiparser_la_LDFLAGS = -version-info 1:5:0
! 
! boost_root = boost_1_34_1
! boost = $(boost_root)/boost
! boostinc = $(includedir)/kml/third_party/$(boost)
! libboostincludedir = $(boostinc)
! libboostinclude_HEADERS = \
! 	${boost}/assert.hpp \
! 	${boost}/checked_delete.hpp \
! 	${boost}/config.hpp \
! 	${boost}/intrusive_ptr.hpp \
! 	${boost}/scoped_ptr.hpp
! 
! libboostdetailincludedir = $(boostinc)/detail
! libboostdetailinclude_HEADERS = \
! 	$(boost)/detail/workaround.hpp
! 
! libboostconfigincludedir = $(boostinc)/config
! libboostconfiginclude_HEADERS = \
! 	$(boost)/config/posix_features.hpp \
! 	$(boost)/config/select_compiler_config.hpp \
! 	$(boost)/config/select_stdlib_config.hpp \
! 	$(boost)/config/select_platform_config.hpp \
! 	$(boost)/config/suffix.hpp \
! 	$(boost)/config/user.hpp
! 
! libboostconfigcompilerincludedir = $(boostinc)/config/compiler
! libboostconfigcompilerinclude_HEADERS = \
! 	$(boost)/config/compiler/gcc.hpp
! 	
! libboostconfigno_tr1includedir = $(boostinc)/config/no_tr1
! libboostconfigno_tr1include_HEADERS = \
! 	$(boost)/config/no_tr1/utility.hpp
! 	
! libboostconfigstdlibincludedir = $(boostinc)/config/stdlib
! libboostconfigstdlibinclude_HEADERS = \
! 	$(boost)/config/stdlib/libstdcpp3.hpp
! 
! libboostconfigplatformincludedir = $(boostinc)/config/platform
! libboostconfigplatforminclude_HEADERS = \
! 	$(boost)/config/platform/linux.hpp \
! 	$(boost)/config/platform/macos.hpp
! 
! libgtest_la_SOURCES = \
! 	gtest-1.7.0/src/gtest-all.cc
! 
! libgtest_main_la_SOURCES = gtest-1.7.0/src/gtest_main.cc
! libgtest_main_la_LIBADD = libgtest.la
! 
! # TODO: add the new gtest libs for windows.
! #	gtest-1.7.0.win32/debug/gtest.lib \
! #	gtest-1.7.0.win32/release/gtest.lib
  
  EXTRA_DIST = \
! 	expat.win32/expat.h \
! 	expat.win32/expat_external.h \
! 	expat.win32/libexpat.dll \
! 	expat.win32/libexpat.lib \
! 	expat.win32/libexpatMT.lib \
! 	expat.win32/libexpatw.dll \
! 	expat.win32/libexpatw.lib \
! 	expat.win32/libexpatwMT.lib \
! 	$(boost_root)/LICENSE_1_0.txt \
! 	$(boost)/README \
! 	$(boost)/config/abi_prefix.hpp \
! 	$(boost)/config/abi_suffix.hpp \
! 	$(boost)/config/auto_link.hpp \
! 	$(boost)/config/abi/borland_prefix.hpp \
! 	$(boost)/config/abi/borland_suffix.hpp \
! 	$(boost)/config/abi/msvc_prefix.hpp \
! 	$(boost)/config/abi/msvc_suffix.hpp \
! 	$(boost)/config/compiler/borland.hpp \
! 	$(boost)/config/compiler/comeau.hpp \
! 	$(boost)/config/compiler/common_edg.hpp \
! 	$(boost)/config/compiler/compaq_cxx.hpp \
! 	$(boost)/config/compiler/digitalmars.hpp \
! 	$(boost)/config/compiler/gcc_xml.hpp \
! 	$(boost)/config/compiler/greenhills.hpp \
! 	$(boost)/config/compiler/hp_acc.hpp \
! 	$(boost)/config/compiler/intel.hpp \
! 	$(boost)/config/compiler/kai.hpp \
! 	$(boost)/config/compiler/metrowerks.hpp \
! 	$(boost)/config/compiler/mpw.hpp \
! 	$(boost)/config/compiler/sgi_mipspro.hpp \
! 	$(boost)/config/compiler/sunpro_cc.hpp \
! 	$(boost)/config/compiler/vacpp.hpp \
! 	$(boost)/config/compiler/visualc.hpp \
! 	$(boost)/config/no_tr1/complex.hpp \
! 	$(boost)/config/no_tr1/functional.hpp \
! 	$(boost)/config/no_tr1/memory.hpp \
! 	$(boost)/config/platform/aix.hpp \
! 	$(boost)/config/platform/amigaos.hpp \
! 	$(boost)/config/platform/beos.hpp \
! 	$(boost)/config/platform/bsd.hpp \
! 	$(boost)/config/platform/cygwin.hpp \
! 	$(boost)/config/platform/hpux.hpp \
! 	$(boost)/config/platform/irix.hpp \
! 	$(boost)/config/platform/qnxnto.hpp \
! 	$(boost)/config/platform/solaris.hpp \
! 	$(boost)/config/platform/win32.hpp \
! 	$(boost)/config/requires_threads.hpp \
! 	$(boost)/config/stdlib/dinkumware.hpp \
! 	$(boost)/config/stdlib/libcomo.hpp \
! 	$(boost)/config/stdlib/modena.hpp \
! 	$(boost)/config/stdlib/msl.hpp \
! 	$(boost)/config/stdlib/roguewave.hpp \
! 	$(boost)/config/stdlib/sgi.hpp \
! 	$(boost)/config/stdlib/stlport.hpp \
! 	$(boost)/config/stdlib/vacpp.hpp \
! 	gtest-1.7.0/include/gtest/gtest-death-test.h \
! 	gtest-1.7.0/include/gtest/gtest-message.h \
! 	gtest-1.7.0/include/gtest/gtest-param-test.h \
! 	gtest-1.7.0/include/gtest/gtest-param-test.h.pump \
! 	gtest-1.7.0/include/gtest/gtest-printers.h \
! 	gtest-1.7.0/include/gtest/gtest-spi.h \
! 	gtest-1.7.0/include/gtest/gtest-test-part.h \
! 	gtest-1.7.0/include/gtest/gtest-typed-test.h \
! 	gtest-1.7.0/include/gtest/gtest.h \
! 	gtest-1.7.0/include/gtest/gtest_pred_impl.h \
! 	gtest-1.7.0/include/gtest/gtest_prod.h \
! 	gtest-1.7.0/include/gtest/internal/gtest-death-test-internal.h \
! 	gtest-1.7.0/include/gtest/internal/gtest-filepath.h \
! 	gtest-1.7.0/include/gtest/internal/gtest-internal.h \
! 	gtest-1.7.0/include/gtest/internal/gtest-linked_ptr.h \
! 	gtest-1.7.0/include/gtest/internal/gtest-param-util-generated.h \
! 	gtest-1.7.0/include/gtest/internal/gtest-param-util-generated.h.pump \
! 	gtest-1.7.0/include/gtest/internal/gtest-param-util.h \
! 	gtest-1.7.0/include/gtest/internal/gtest-port.h \
! 	gtest-1.7.0/include/gtest/internal/gtest-string.h \
! 	gtest-1.7.0/include/gtest/internal/gtest-tuple.h \
! 	gtest-1.7.0/include/gtest/internal/gtest-tuple.h.pump \
! 	gtest-1.7.0/include/gtest/internal/gtest-type-util.h \
! 	gtest-1.7.0/include/gtest/internal/gtest-type-util.h.pump \
! 	gtest-1.7.0/src/gtest-death-test.cc \
! 	gtest-1.7.0/src/gtest-filepath.cc \
! 	gtest-1.7.0/src/gtest-internal-inl.h \
! 	gtest-1.7.0/src/gtest-port.cc \
! 	gtest-1.7.0/src/gtest-printers.cc \
! 	gtest-1.7.0/src/gtest-test-part.cc \
! 	gtest-1.7.0/src/gtest-typed-test.cc \
! 	gtest-1.7.0/src/gtest.cc \
! 	uriparser-0.7.5/COPYING \
! 	uriparser-0.7.5.win32/debug/uriparser.lib \
! 	uriparser-0.7.5.win32/release/uriparser.lib \
! 	uriparser-0.7.5/include/uriparser/Uri.h \
! 	uriparser-0.7.5/include/uriparser/UriBase.h \
! 	uriparser-0.7.5/include/uriparser/UriDefsAnsi.h \
! 	uriparser-0.7.5/include/uriparser/UriDefsConfig.h \
! 	uriparser-0.7.5/include/uriparser/UriDefsUnicode.h \
! 	uriparser-0.7.5/include/uriparser/UriIp4.h \
! 	zlib-1.2.3/zconf.h \
! 	zlib-1.2.3/zlib.h \
! 	zlib-1.2.3/contrib/minizip/crypt.h \
! 	zlib-1.2.3/contrib/minizip/ioapi.h \
! 	zlib-1.2.3/contrib/minizip/iowin32.c \
! 	zlib-1.2.3/contrib/minizip/iowin32.h \
! 	zlib-1.2.3/contrib/minizip/miniunz.c \
! 	zlib-1.2.3/contrib/minizip/minizip.c \
! 	zlib-1.2.3/contrib/minizip/mztools.c \
! 	zlib-1.2.3/contrib/minizip/mztools.h \
! 	zlib-1.2.3/contrib/minizip/unzip.h \
! 	zlib-1.2.3/contrib/minizip/zip.h \
! 	zlib-1.2.3.win32/bin/minizip.dll \
! 	zlib-1.2.3.win32/bin/zlib1.dll \
! 	zlib-1.2.3.win32/lib/minizip.lib \
! 	zlib-1.2.3.win32/lib/zdll.lib \
! 	zlib-1.2.3.win32/lib/zlib.lib
! 
--- 1,17 ----
! AM_CPPFLAGS = -I$(top_srcdir)/third_party/minizipext-1.0
  
! noinst_LTLIBRARIES = libminizipext.la
! libminizipext_la_SOURCES = \
! 	minizipext-1.0/fseek.c \
! 	minizipext-1.0/iomem_simple.c \
! 	minizipext-1.0/unzipx.c
! libminizipext_la_LIBADD = -lminizip -lz
  
  EXTRA_DIST = \
! 	expat.win32 \
! 	boost_1_34_1 \
! 	gtest-1.7.0 \
! 	uriparser-0.7.5 \
! 	uriparser-0.7.5.win32 \
! 	zlib-1.2.3 \
! 	zlib-1.2.3.win32
